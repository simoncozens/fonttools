

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>fontTools.ttLib.tables.otConverters &mdash; fontTools Documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home"> fontTools
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Library</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../afmLib.html">afmLib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../agl.html">agl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../cffLib/index.html">cffLib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../colorLib/index.html">colorLib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../cu2qu/index.html">cu2qu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../designspaceLib/index.html">designspaceLib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../encodings/index.html">encodings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../feaLib/index.html">feaLib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../merge.html">merge</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../misc/index.html">misc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../mtiLib.html">mtiLib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../otlLib/index.html">otlLib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../pens/index.html">pens</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../subset/index.html">subset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../svgLib/index.html">svgLib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../t1Lib.html">t1Lib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../ttLib/index.html">ttLib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../ttx.html">ttx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../ufoLib/index.html">ufoLib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../unicode.html">unicode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../unicodedata/index.html">unicodedata</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../varLib/index.html">varLib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../voltLib.html">voltLib</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">fontTools</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../index.html">Module code</a> &raquo;</li>
        
          <li><a href="../../ttLib.html">fontTools.ttLib</a> &raquo;</li>
        
      <li>fontTools.ttLib.tables.otConverters</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for fontTools.ttLib.tables.otConverters</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">fontTools.misc.py23</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">fontTools.misc.fixedTools</span> <span class="k">import</span> <span class="p">(</span>
	<span class="n">fixedToFloat</span> <span class="k">as</span> <span class="n">fi2fl</span><span class="p">,</span>
	<span class="n">floatToFixed</span> <span class="k">as</span> <span class="n">fl2fi</span><span class="p">,</span>
	<span class="n">floatToFixedToStr</span> <span class="k">as</span> <span class="n">fl2str</span><span class="p">,</span>
	<span class="n">strToFixedToFloat</span> <span class="k">as</span> <span class="n">str2fl</span><span class="p">,</span>
	<span class="n">ensureVersionIsLong</span> <span class="k">as</span> <span class="n">fi2ve</span><span class="p">,</span>
	<span class="n">versionToFixed</span> <span class="k">as</span> <span class="n">ve2fi</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">fontTools.misc.textTools</span> <span class="k">import</span> <span class="n">pad</span><span class="p">,</span> <span class="n">safeEval</span>
<span class="kn">from</span> <span class="nn">fontTools.ttLib</span> <span class="k">import</span> <span class="n">getSearchRange</span>
<span class="kn">from</span> <span class="nn">.otBase</span> <span class="k">import</span> <span class="p">(</span><span class="n">CountReference</span><span class="p">,</span> <span class="n">FormatSwitchingBaseTable</span><span class="p">,</span>
                     <span class="n">OTTableReader</span><span class="p">,</span> <span class="n">OTTableWriter</span><span class="p">,</span> <span class="n">ValueRecordFactory</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">.otTables</span> <span class="k">import</span> <span class="p">(</span><span class="n">lookupTypes</span><span class="p">,</span> <span class="n">AATStateTable</span><span class="p">,</span> <span class="n">AATState</span><span class="p">,</span> <span class="n">AATAction</span><span class="p">,</span>
                       <span class="n">ContextualMorphAction</span><span class="p">,</span> <span class="n">LigatureMorphAction</span><span class="p">,</span>
                       <span class="n">InsertionMorphAction</span><span class="p">,</span> <span class="n">MorxSubtable</span><span class="p">,</span> <span class="n">VariableFloat</span><span class="p">,</span>
                       <span class="n">VariableInt</span><span class="p">,</span> <span class="n">ExtendMode</span> <span class="k">as</span> <span class="n">_ExtendMode</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="k">import</span> <span class="n">zip_longest</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="k">import</span> <span class="n">partial</span>
<span class="kn">import</span> <span class="nn">struct</span>
<span class="kn">import</span> <span class="nn">logging</span>


<span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="n">istuple</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>


<div class="viewcode-block" id="buildConverters"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.buildConverters">[docs]</a><span class="k">def</span> <span class="nf">buildConverters</span><span class="p">(</span><span class="n">tableSpec</span><span class="p">,</span> <span class="n">tableNamespace</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Given a table spec from otData.py, build a converter object for each</span>
<span class="sd">	field of the table. This is called for each table in otData.py, and</span>
<span class="sd">	the results are assigned to the corresponding class in otTables.py.&quot;&quot;&quot;</span>
	<span class="n">converters</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="n">convertersByName</span> <span class="o">=</span> <span class="p">{}</span>
	<span class="k">for</span> <span class="n">tp</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">repeat</span><span class="p">,</span> <span class="n">aux</span><span class="p">,</span> <span class="n">descr</span> <span class="ow">in</span> <span class="n">tableSpec</span><span class="p">:</span>
		<span class="n">tableName</span> <span class="o">=</span> <span class="n">name</span>
		<span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;ValueFormat&quot;</span><span class="p">):</span>
			<span class="k">assert</span> <span class="n">tp</span> <span class="o">==</span> <span class="s2">&quot;uint16&quot;</span>
			<span class="n">converterClass</span> <span class="o">=</span> <span class="n">ValueFormat</span>
		<span class="k">elif</span> <span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;Count&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;StructLength&quot;</span><span class="p">,</span> <span class="s2">&quot;MorphType&quot;</span><span class="p">):</span>
			<span class="n">converterClass</span> <span class="o">=</span> <span class="p">{</span>
				<span class="s2">&quot;uint8&quot;</span><span class="p">:</span> <span class="n">ComputedUInt8</span><span class="p">,</span>
				<span class="s2">&quot;uint16&quot;</span><span class="p">:</span> <span class="n">ComputedUShort</span><span class="p">,</span>
				<span class="s2">&quot;uint32&quot;</span><span class="p">:</span> <span class="n">ComputedULong</span><span class="p">,</span>
			<span class="p">}[</span><span class="n">tp</span><span class="p">]</span>
		<span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;SubTable&quot;</span><span class="p">:</span>
			<span class="n">converterClass</span> <span class="o">=</span> <span class="n">SubTable</span>
		<span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;ExtSubTable&quot;</span><span class="p">:</span>
			<span class="n">converterClass</span> <span class="o">=</span> <span class="n">ExtSubTable</span>
		<span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;SubStruct&quot;</span><span class="p">:</span>
			<span class="n">converterClass</span> <span class="o">=</span> <span class="n">SubStruct</span>
		<span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;FeatureParams&quot;</span><span class="p">:</span>
			<span class="n">converterClass</span> <span class="o">=</span> <span class="n">FeatureParams</span>
		<span class="k">elif</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;CIDGlyphMapping&quot;</span><span class="p">,</span> <span class="s2">&quot;GlyphCIDMapping&quot;</span><span class="p">):</span>
			<span class="n">converterClass</span> <span class="o">=</span> <span class="n">StructWithLength</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">tp</span> <span class="ow">in</span> <span class="n">converterMapping</span> <span class="ow">and</span> <span class="s1">&#39;(&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tp</span><span class="p">:</span>
				<span class="n">tableName</span> <span class="o">=</span> <span class="n">tp</span>
				<span class="n">converterClass</span> <span class="o">=</span> <span class="n">Struct</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">converterClass</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">tp</span><span class="p">,</span> <span class="n">tableNamespace</span><span class="p">,</span> <span class="n">converterMapping</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">tp</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;MortChain&#39;</span><span class="p">,</span> <span class="s1">&#39;MortSubtable&#39;</span><span class="p">,</span> <span class="s1">&#39;MorxChain&#39;</span><span class="p">):</span>
			<span class="n">tableClass</span> <span class="o">=</span> <span class="n">tableNamespace</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">tp</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">tableClass</span> <span class="o">=</span> <span class="n">tableNamespace</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">tableName</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">tableClass</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
			<span class="n">conv</span> <span class="o">=</span> <span class="n">converterClass</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">repeat</span><span class="p">,</span> <span class="n">aux</span><span class="p">,</span> <span class="n">tableClass</span><span class="o">=</span><span class="n">tableClass</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">conv</span> <span class="o">=</span> <span class="n">converterClass</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">repeat</span><span class="p">,</span> <span class="n">aux</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;SubTable&quot;</span><span class="p">,</span> <span class="s2">&quot;ExtSubTable&quot;</span><span class="p">,</span> <span class="s2">&quot;SubStruct&quot;</span><span class="p">]:</span>
			<span class="n">conv</span><span class="o">.</span><span class="n">lookupTypes</span> <span class="o">=</span> <span class="n">tableNamespace</span><span class="p">[</span><span class="s1">&#39;lookupTypes&#39;</span><span class="p">]</span>
			<span class="c1"># also create reverse mapping</span>
			<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">conv</span><span class="o">.</span><span class="n">lookupTypes</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
				<span class="k">for</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
					<span class="n">convertersByName</span><span class="p">[</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">repeat</span><span class="p">,</span> <span class="n">aux</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;FeatureParams&quot;</span><span class="p">:</span>
			<span class="n">conv</span><span class="o">.</span><span class="n">featureParamTypes</span> <span class="o">=</span> <span class="n">tableNamespace</span><span class="p">[</span><span class="s1">&#39;featureParamTypes&#39;</span><span class="p">]</span>
			<span class="n">conv</span><span class="o">.</span><span class="n">defaultFeatureParams</span> <span class="o">=</span> <span class="n">tableNamespace</span><span class="p">[</span><span class="s1">&#39;FeatureParams&#39;</span><span class="p">]</span>
			<span class="k">for</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="n">conv</span><span class="o">.</span><span class="n">featureParamTypes</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
				<span class="n">convertersByName</span><span class="p">[</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">repeat</span><span class="p">,</span> <span class="n">aux</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)</span>
		<span class="n">converters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">conv</span><span class="p">)</span>
		<span class="k">assert</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">convertersByName</span><span class="p">,</span> <span class="n">name</span>
		<span class="n">convertersByName</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">conv</span>
	<span class="k">return</span> <span class="n">converters</span><span class="p">,</span> <span class="n">convertersByName</span></div>


<span class="k">class</span> <span class="nc">_MissingItem</span><span class="p">(</span><span class="nb">tuple</span><span class="p">):</span>
	<span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>


<span class="k">try</span><span class="p">:</span>
	<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">UserList</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
	<span class="kn">from</span> <span class="nn">UserList</span> <span class="k">import</span> <span class="n">UserList</span>


<span class="k">class</span> <span class="nc">_LazyList</span><span class="p">(</span><span class="n">UserList</span><span class="p">):</span>

	<span class="k">def</span> <span class="nf">__getslice__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>

	<span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
			<span class="n">indices</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="o">*</span><span class="n">k</span><span class="o">.</span><span class="n">indices</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)))</span>
			<span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
		<span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">_MissingItem</span><span class="p">):</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">+</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">recordSize</span><span class="p">)</span>
			<span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conv</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">font</span><span class="p">,</span> <span class="p">{})</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span>
		<span class="k">return</span> <span class="n">item</span>

	<span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">_LazyList</span><span class="p">):</span>
			<span class="n">other</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
			<span class="k">pass</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">NotImplemented</span>
		<span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">+</span> <span class="n">other</span>

	<span class="k">def</span> <span class="nf">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
			<span class="k">return</span> <span class="bp">NotImplemented</span>
		<span class="k">return</span> <span class="n">other</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>


<div class="viewcode-block" id="BaseConverter"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.BaseConverter">[docs]</a><span class="k">class</span> <span class="nc">BaseConverter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

	<span class="sd">&quot;&quot;&quot;Base class for converter objects. Apart from the constructor, this</span>
<span class="sd">	is an abstract class.&quot;&quot;&quot;</span>

	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">repeat</span><span class="p">,</span> <span class="n">aux</span><span class="p">,</span> <span class="n">tableClass</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">repeat</span> <span class="o">=</span> <span class="n">repeat</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">aux</span> <span class="o">=</span> <span class="n">aux</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">tableClass</span> <span class="o">=</span> <span class="n">tableClass</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">isCount</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;Count&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;DesignAxisRecordSize&#39;</span><span class="p">,</span> <span class="s1">&#39;ValueRecordSize&#39;</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">isLookupType</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;LookupType&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;MorphType&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">isPropagated</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[</span>
			<span class="s2">&quot;ClassCount&quot;</span><span class="p">,</span>
			<span class="s2">&quot;Class2Count&quot;</span><span class="p">,</span>
			<span class="s2">&quot;FeatureTag&quot;</span><span class="p">,</span>
			<span class="s2">&quot;SettingsCount&quot;</span><span class="p">,</span>
			<span class="s2">&quot;VarRegionCount&quot;</span><span class="p">,</span>
			<span class="s2">&quot;MappingCount&quot;</span><span class="p">,</span>
			<span class="s2">&quot;RegionAxisCount&quot;</span><span class="p">,</span>
			<span class="s2">&quot;DesignAxisCount&quot;</span><span class="p">,</span>
			<span class="s2">&quot;DesignAxisRecordSize&quot;</span><span class="p">,</span>
			<span class="s2">&quot;AxisValueCount&quot;</span><span class="p">,</span>
			<span class="s2">&quot;ValueRecordSize&quot;</span><span class="p">,</span>
			<span class="s2">&quot;AxisCount&quot;</span><span class="p">,</span>
			<span class="s2">&quot;BaseGlyphRecordCount&quot;</span><span class="p">,</span>
			<span class="s2">&quot;LayerRecordCount&quot;</span><span class="p">,</span>
		<span class="p">]</span>

<div class="viewcode-block" id="BaseConverter.readArray"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.BaseConverter.readArray">[docs]</a>	<span class="k">def</span> <span class="nf">readArray</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="n">count</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Read an array of values from the reader.&quot;&quot;&quot;</span>
		<span class="n">lazy</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">lazy</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="mi">8</span>
		<span class="k">if</span> <span class="n">lazy</span><span class="p">:</span>
			<span class="n">recordSize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRecordSize</span><span class="p">(</span><span class="n">reader</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">recordSize</span> <span class="ow">is</span> <span class="bp">NotImplemented</span><span class="p">:</span>
				<span class="n">lazy</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">lazy</span><span class="p">:</span>
			<span class="n">l</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">count</span><span class="p">):</span>
				<span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">))</span>
			<span class="k">return</span> <span class="n">l</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">l</span> <span class="o">=</span> <span class="n">_LazyList</span><span class="p">()</span>
			<span class="n">l</span><span class="o">.</span><span class="n">reader</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
			<span class="n">l</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">pos</span>
			<span class="n">l</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">font</span>
			<span class="n">l</span><span class="o">.</span><span class="n">conv</span> <span class="o">=</span> <span class="bp">self</span>
			<span class="n">l</span><span class="o">.</span><span class="n">recordSize</span> <span class="o">=</span> <span class="n">recordSize</span>
			<span class="n">l</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">_MissingItem</span><span class="p">([</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">count</span><span class="p">))</span>
			<span class="n">reader</span><span class="o">.</span><span class="n">advance</span><span class="p">(</span><span class="n">count</span> <span class="o">*</span> <span class="n">recordSize</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">l</span></div>

<div class="viewcode-block" id="BaseConverter.getRecordSize"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.BaseConverter.getRecordSize">[docs]</a>	<span class="k">def</span> <span class="nf">getRecordSize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">):</span>
		<span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;staticSize&#39;</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">staticSize</span>
		<span class="k">return</span> <span class="bp">NotImplemented</span></div>

<div class="viewcode-block" id="BaseConverter.read"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.BaseConverter.read">[docs]</a>	<span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Read a value from the reader.&quot;&quot;&quot;</span>
		<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="BaseConverter.writeArray"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.BaseConverter.writeArray">[docs]</a>	<span class="k">def</span> <span class="nf">writeArray</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span></div>

<div class="viewcode-block" id="BaseConverter.write"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.BaseConverter.write">[docs]</a>	<span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">repeatIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Write a value to the writer.&quot;&quot;&quot;</span>
		<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="BaseConverter.xmlRead"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.BaseConverter.xmlRead">[docs]</a>	<span class="k">def</span> <span class="nf">xmlRead</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">font</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Read a value from XML.&quot;&quot;&quot;</span>
		<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="BaseConverter.xmlWrite"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.BaseConverter.xmlWrite">[docs]</a>	<span class="k">def</span> <span class="nf">xmlWrite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmlWriter</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Write a value to XML.&quot;&quot;&quot;</span>
		<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="SimpleValue"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.SimpleValue">[docs]</a><span class="k">class</span> <span class="nc">SimpleValue</span><span class="p">(</span><span class="n">BaseConverter</span><span class="p">):</span>
<div class="viewcode-block" id="SimpleValue.toString"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.SimpleValue.toString">[docs]</a>	<span class="nd">@staticmethod</span>
	<span class="k">def</span> <span class="nf">toString</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">value</span></div>
<div class="viewcode-block" id="SimpleValue.fromString"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.SimpleValue.fromString">[docs]</a>	<span class="nd">@staticmethod</span>
	<span class="k">def</span> <span class="nf">fromString</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">value</span></div>
<div class="viewcode-block" id="SimpleValue.xmlWrite"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.SimpleValue.xmlWrite">[docs]</a>	<span class="k">def</span> <span class="nf">xmlWrite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmlWriter</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">simpletag</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">attrs</span> <span class="o">+</span> <span class="p">[(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toString</span><span class="p">(</span><span class="n">value</span><span class="p">))])</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span></div>
<div class="viewcode-block" id="SimpleValue.xmlRead"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.SimpleValue.xmlRead">[docs]</a>	<span class="k">def</span> <span class="nf">xmlRead</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">font</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fromString</span><span class="p">(</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">])</span></div></div>

<div class="viewcode-block" id="IntValue"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.IntValue">[docs]</a><span class="k">class</span> <span class="nc">IntValue</span><span class="p">(</span><span class="n">SimpleValue</span><span class="p">):</span>
<div class="viewcode-block" id="IntValue.fromString"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.IntValue.fromString">[docs]</a>	<span class="nd">@staticmethod</span>
	<span class="k">def</span> <span class="nf">fromString</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
		<span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="Long"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Long">[docs]</a><span class="k">class</span> <span class="nc">Long</span><span class="p">(</span><span class="n">IntValue</span><span class="p">):</span>
	<span class="n">staticSize</span> <span class="o">=</span> <span class="mi">4</span>
<div class="viewcode-block" id="Long.read"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Long.read">[docs]</a>	<span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">reader</span><span class="o">.</span><span class="n">readLong</span><span class="p">()</span></div>
<div class="viewcode-block" id="Long.write"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Long.write">[docs]</a>	<span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">repeatIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeLong</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="ULong"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.ULong">[docs]</a><span class="k">class</span> <span class="nc">ULong</span><span class="p">(</span><span class="n">IntValue</span><span class="p">):</span>
	<span class="n">staticSize</span> <span class="o">=</span> <span class="mi">4</span>
<div class="viewcode-block" id="ULong.read"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.ULong.read">[docs]</a>	<span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">reader</span><span class="o">.</span><span class="n">readULong</span><span class="p">()</span></div>
<div class="viewcode-block" id="ULong.write"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.ULong.write">[docs]</a>	<span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">repeatIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeULong</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="Flags32"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Flags32">[docs]</a><span class="k">class</span> <span class="nc">Flags32</span><span class="p">(</span><span class="n">ULong</span><span class="p">):</span>
<div class="viewcode-block" id="Flags32.toString"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Flags32.toString">[docs]</a>	<span class="nd">@staticmethod</span>
	<span class="k">def</span> <span class="nf">toString</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
		<span class="k">return</span> <span class="s2">&quot;0x</span><span class="si">%08X</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">value</span></div></div>

<div class="viewcode-block" id="Short"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Short">[docs]</a><span class="k">class</span> <span class="nc">Short</span><span class="p">(</span><span class="n">IntValue</span><span class="p">):</span>
	<span class="n">staticSize</span> <span class="o">=</span> <span class="mi">2</span>
<div class="viewcode-block" id="Short.read"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Short.read">[docs]</a>	<span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">reader</span><span class="o">.</span><span class="n">readShort</span><span class="p">()</span></div>
<div class="viewcode-block" id="Short.write"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Short.write">[docs]</a>	<span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">repeatIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeShort</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="UShort"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.UShort">[docs]</a><span class="k">class</span> <span class="nc">UShort</span><span class="p">(</span><span class="n">IntValue</span><span class="p">):</span>
	<span class="n">staticSize</span> <span class="o">=</span> <span class="mi">2</span>
<div class="viewcode-block" id="UShort.read"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.UShort.read">[docs]</a>	<span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">reader</span><span class="o">.</span><span class="n">readUShort</span><span class="p">()</span></div>
<div class="viewcode-block" id="UShort.write"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.UShort.write">[docs]</a>	<span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">repeatIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeUShort</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="Int8"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Int8">[docs]</a><span class="k">class</span> <span class="nc">Int8</span><span class="p">(</span><span class="n">IntValue</span><span class="p">):</span>
	<span class="n">staticSize</span> <span class="o">=</span> <span class="mi">1</span>
<div class="viewcode-block" id="Int8.read"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Int8.read">[docs]</a>	<span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">reader</span><span class="o">.</span><span class="n">readInt8</span><span class="p">()</span></div>
<div class="viewcode-block" id="Int8.write"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Int8.write">[docs]</a>	<span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">repeatIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeInt8</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="UInt8"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.UInt8">[docs]</a><span class="k">class</span> <span class="nc">UInt8</span><span class="p">(</span><span class="n">IntValue</span><span class="p">):</span>
	<span class="n">staticSize</span> <span class="o">=</span> <span class="mi">1</span>
<div class="viewcode-block" id="UInt8.read"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.UInt8.read">[docs]</a>	<span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">reader</span><span class="o">.</span><span class="n">readUInt8</span><span class="p">()</span></div>
<div class="viewcode-block" id="UInt8.write"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.UInt8.write">[docs]</a>	<span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">repeatIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeUInt8</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="UInt24"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.UInt24">[docs]</a><span class="k">class</span> <span class="nc">UInt24</span><span class="p">(</span><span class="n">IntValue</span><span class="p">):</span>
	<span class="n">staticSize</span> <span class="o">=</span> <span class="mi">3</span>
<div class="viewcode-block" id="UInt24.read"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.UInt24.read">[docs]</a>	<span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">reader</span><span class="o">.</span><span class="n">readUInt24</span><span class="p">()</span></div>
<div class="viewcode-block" id="UInt24.write"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.UInt24.write">[docs]</a>	<span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">repeatIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeUInt24</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="ComputedInt"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.ComputedInt">[docs]</a><span class="k">class</span> <span class="nc">ComputedInt</span><span class="p">(</span><span class="n">IntValue</span><span class="p">):</span>
<div class="viewcode-block" id="ComputedInt.xmlWrite"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.ComputedInt.xmlWrite">[docs]</a>	<span class="k">def</span> <span class="nf">xmlWrite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmlWriter</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
			<span class="n">xmlWriter</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">=</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
			<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span></div></div>

<div class="viewcode-block" id="ComputedUInt8"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.ComputedUInt8">[docs]</a><span class="k">class</span> <span class="nc">ComputedUInt8</span><span class="p">(</span><span class="n">ComputedInt</span><span class="p">,</span> <span class="n">UInt8</span><span class="p">):</span>
	<span class="k">pass</span></div>
<div class="viewcode-block" id="ComputedUShort"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.ComputedUShort">[docs]</a><span class="k">class</span> <span class="nc">ComputedUShort</span><span class="p">(</span><span class="n">ComputedInt</span><span class="p">,</span> <span class="n">UShort</span><span class="p">):</span>
	<span class="k">pass</span></div>
<div class="viewcode-block" id="ComputedULong"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.ComputedULong">[docs]</a><span class="k">class</span> <span class="nc">ComputedULong</span><span class="p">(</span><span class="n">ComputedInt</span><span class="p">,</span> <span class="n">ULong</span><span class="p">):</span>
	<span class="k">pass</span></div>

<div class="viewcode-block" id="Tag"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Tag">[docs]</a><span class="k">class</span> <span class="nc">Tag</span><span class="p">(</span><span class="n">SimpleValue</span><span class="p">):</span>
	<span class="n">staticSize</span> <span class="o">=</span> <span class="mi">4</span>
<div class="viewcode-block" id="Tag.read"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Tag.read">[docs]</a>	<span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">reader</span><span class="o">.</span><span class="n">readTag</span><span class="p">()</span></div>
<div class="viewcode-block" id="Tag.write"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Tag.write">[docs]</a>	<span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">repeatIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeTag</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="GlyphID"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.GlyphID">[docs]</a><span class="k">class</span> <span class="nc">GlyphID</span><span class="p">(</span><span class="n">SimpleValue</span><span class="p">):</span>
	<span class="n">staticSize</span> <span class="o">=</span> <span class="mi">2</span>
<div class="viewcode-block" id="GlyphID.readArray"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.GlyphID.readArray">[docs]</a>	<span class="k">def</span> <span class="nf">readArray</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="n">count</span><span class="p">):</span>
		<span class="n">glyphOrder</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">getGlyphOrder</span><span class="p">()</span>
		<span class="n">gids</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">readUShortArray</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="n">glyphOrder</span><span class="p">[</span><span class="n">gid</span><span class="p">]</span> <span class="k">for</span> <span class="n">gid</span> <span class="ow">in</span> <span class="n">gids</span><span class="p">]</span>
		<span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
			<span class="c1"># Slower, but will not throw an IndexError on an invalid glyph id.</span>
			<span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="n">font</span><span class="o">.</span><span class="n">getGlyphName</span><span class="p">(</span><span class="n">gid</span><span class="p">)</span> <span class="k">for</span> <span class="n">gid</span> <span class="ow">in</span> <span class="n">gids</span><span class="p">]</span>
		<span class="k">return</span> <span class="n">l</span></div>
<div class="viewcode-block" id="GlyphID.read"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.GlyphID.read">[docs]</a>	<span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">font</span><span class="o">.</span><span class="n">getGlyphName</span><span class="p">(</span><span class="n">reader</span><span class="o">.</span><span class="n">readUShort</span><span class="p">())</span></div>
<div class="viewcode-block" id="GlyphID.write"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.GlyphID.write">[docs]</a>	<span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">repeatIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeUShort</span><span class="p">(</span><span class="n">font</span><span class="o">.</span><span class="n">getGlyphID</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></div></div>


<div class="viewcode-block" id="NameID"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.NameID">[docs]</a><span class="k">class</span> <span class="nc">NameID</span><span class="p">(</span><span class="n">UShort</span><span class="p">):</span>
<div class="viewcode-block" id="NameID.xmlWrite"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.NameID.xmlWrite">[docs]</a>	<span class="k">def</span> <span class="nf">xmlWrite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmlWriter</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">simpletag</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">attrs</span> <span class="o">+</span> <span class="p">[(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)])</span>
		<span class="k">if</span> <span class="n">font</span> <span class="ow">and</span> <span class="n">value</span><span class="p">:</span>
			<span class="n">nameTable</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">nameTable</span><span class="p">:</span>
				<span class="n">name</span> <span class="o">=</span> <span class="n">nameTable</span><span class="o">.</span><span class="n">getDebugName</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
				<span class="n">xmlWriter</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">name</span><span class="p">:</span>
					<span class="n">xmlWriter</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">xmlWriter</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="s2">&quot;missing from name table&quot;</span><span class="p">)</span>
					<span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;name id </span><span class="si">%d</span><span class="s2"> missing from name table&quot;</span> <span class="o">%</span> <span class="n">value</span><span class="p">)</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="FloatValue"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.FloatValue">[docs]</a><span class="k">class</span> <span class="nc">FloatValue</span><span class="p">(</span><span class="n">SimpleValue</span><span class="p">):</span>
<div class="viewcode-block" id="FloatValue.fromString"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.FloatValue.fromString">[docs]</a>	<span class="nd">@staticmethod</span>
	<span class="k">def</span> <span class="nf">fromString</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
		<span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="DeciPoints"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.DeciPoints">[docs]</a><span class="k">class</span> <span class="nc">DeciPoints</span><span class="p">(</span><span class="n">FloatValue</span><span class="p">):</span>
	<span class="n">staticSize</span> <span class="o">=</span> <span class="mi">2</span>
<div class="viewcode-block" id="DeciPoints.read"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.DeciPoints.read">[docs]</a>	<span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">reader</span><span class="o">.</span><span class="n">readUShort</span><span class="p">()</span> <span class="o">/</span> <span class="mi">10</span></div>

<div class="viewcode-block" id="DeciPoints.write"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.DeciPoints.write">[docs]</a>	<span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">repeatIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeUShort</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">value</span> <span class="o">*</span> <span class="mi">10</span><span class="p">))</span></div></div>

<div class="viewcode-block" id="Fixed"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Fixed">[docs]</a><span class="k">class</span> <span class="nc">Fixed</span><span class="p">(</span><span class="n">FloatValue</span><span class="p">):</span>
	<span class="n">staticSize</span> <span class="o">=</span> <span class="mi">4</span>
<div class="viewcode-block" id="Fixed.read"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Fixed.read">[docs]</a>	<span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">):</span>
		<span class="k">return</span>  <span class="n">fi2fl</span><span class="p">(</span><span class="n">reader</span><span class="o">.</span><span class="n">readLong</span><span class="p">(),</span> <span class="mi">16</span><span class="p">)</span></div>
<div class="viewcode-block" id="Fixed.write"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Fixed.write">[docs]</a>	<span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">repeatIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeLong</span><span class="p">(</span><span class="n">fl2fi</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span></div>
<div class="viewcode-block" id="Fixed.fromString"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Fixed.fromString">[docs]</a>	<span class="nd">@staticmethod</span>
	<span class="k">def</span> <span class="nf">fromString</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">str2fl</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span></div>
<div class="viewcode-block" id="Fixed.toString"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Fixed.toString">[docs]</a>	<span class="nd">@staticmethod</span>
	<span class="k">def</span> <span class="nf">toString</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">fl2str</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="F2Dot14"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.F2Dot14">[docs]</a><span class="k">class</span> <span class="nc">F2Dot14</span><span class="p">(</span><span class="n">FloatValue</span><span class="p">):</span>
	<span class="n">staticSize</span> <span class="o">=</span> <span class="mi">2</span>
<div class="viewcode-block" id="F2Dot14.read"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.F2Dot14.read">[docs]</a>	<span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">):</span>
		<span class="k">return</span>  <span class="n">fi2fl</span><span class="p">(</span><span class="n">reader</span><span class="o">.</span><span class="n">readShort</span><span class="p">(),</span> <span class="mi">14</span><span class="p">)</span></div>
<div class="viewcode-block" id="F2Dot14.write"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.F2Dot14.write">[docs]</a>	<span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">repeatIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeShort</span><span class="p">(</span><span class="n">fl2fi</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="mi">14</span><span class="p">))</span></div>
<div class="viewcode-block" id="F2Dot14.fromString"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.F2Dot14.fromString">[docs]</a>	<span class="nd">@staticmethod</span>
	<span class="k">def</span> <span class="nf">fromString</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">str2fl</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span></div>
<div class="viewcode-block" id="F2Dot14.toString"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.F2Dot14.toString">[docs]</a>	<span class="nd">@staticmethod</span>
	<span class="k">def</span> <span class="nf">toString</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">fl2str</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="Version"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Version">[docs]</a><span class="k">class</span> <span class="nc">Version</span><span class="p">(</span><span class="n">SimpleValue</span><span class="p">):</span>
	<span class="n">staticSize</span> <span class="o">=</span> <span class="mi">4</span>
<div class="viewcode-block" id="Version.read"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Version.read">[docs]</a>	<span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">):</span>
		<span class="n">value</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">readLong</span><span class="p">()</span>
		<span class="k">assert</span> <span class="p">(</span><span class="n">value</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Unsupported version 0x</span><span class="si">%08x</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">value</span>
		<span class="k">return</span> <span class="n">value</span></div>
<div class="viewcode-block" id="Version.write"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Version.write">[docs]</a>	<span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">repeatIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="n">value</span> <span class="o">=</span> <span class="n">fi2ve</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
		<span class="k">assert</span> <span class="p">(</span><span class="n">value</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Unsupported version 0x</span><span class="si">%08x</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">value</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeLong</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>
<div class="viewcode-block" id="Version.fromString"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Version.fromString">[docs]</a>	<span class="nd">@staticmethod</span>
	<span class="k">def</span> <span class="nf">fromString</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">ve2fi</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>
<div class="viewcode-block" id="Version.toString"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Version.toString">[docs]</a>	<span class="nd">@staticmethod</span>
	<span class="k">def</span> <span class="nf">toString</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
		<span class="k">return</span> <span class="s2">&quot;0x</span><span class="si">%08x</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">value</span></div>
<div class="viewcode-block" id="Version.fromFloat"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Version.fromFloat">[docs]</a>	<span class="nd">@staticmethod</span>
	<span class="k">def</span> <span class="nf">fromFloat</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">fl2fi</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Char64"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Char64">[docs]</a><span class="k">class</span> <span class="nc">Char64</span><span class="p">(</span><span class="n">SimpleValue</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;An ASCII string with up to 64 characters.</span>

<span class="sd">	Unused character positions are filled with 0x00 bytes.</span>
<span class="sd">	Used in Apple AAT fonts in the `gcid` table.</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">staticSize</span> <span class="o">=</span> <span class="mi">64</span>

<div class="viewcode-block" id="Char64.read"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Char64.read">[docs]</a>	<span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">):</span>
		<span class="n">data</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">readData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">staticSize</span><span class="p">)</span>
		<span class="n">zeroPos</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;</span><span class="se">\0</span><span class="s2">&quot;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">zeroPos</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
			<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:</span><span class="n">zeroPos</span><span class="p">]</span>
		<span class="n">s</span> <span class="o">=</span> <span class="n">tounicode</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;ascii&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;replace&quot;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">s</span> <span class="o">!=</span> <span class="n">tounicode</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;ascii&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">):</span>
			<span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;replaced non-ASCII characters in &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span>
			            <span class="n">s</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">s</span></div>

<div class="viewcode-block" id="Char64.write"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Char64.write">[docs]</a>	<span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">repeatIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="n">data</span> <span class="o">=</span> <span class="n">tobytes</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;ascii&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;replace&quot;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">data</span> <span class="o">!=</span> <span class="n">tobytes</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;ascii&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">):</span>
			<span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;replacing non-ASCII characters in &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span>
			            <span class="n">value</span><span class="p">)</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">staticSize</span><span class="p">:</span>
			<span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;truncating overlong &quot;</span><span class="si">%s</span><span class="s1">&quot; to </span><span class="si">%d</span><span class="s1"> bytes&#39;</span> <span class="o">%</span>
			            <span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">staticSize</span><span class="p">))</span>
		<span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span> <span class="o">+</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\0</span><span class="s2">&quot;</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">staticSize</span><span class="p">)[:</span><span class="bp">self</span><span class="o">.</span><span class="n">staticSize</span><span class="p">]</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeData</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Struct"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Struct">[docs]</a><span class="k">class</span> <span class="nc">Struct</span><span class="p">(</span><span class="n">BaseConverter</span><span class="p">):</span>

<div class="viewcode-block" id="Struct.getRecordSize"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Struct.getRecordSize">[docs]</a>	<span class="k">def</span> <span class="nf">getRecordSize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableClass</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableClass</span><span class="o">.</span><span class="n">getRecordSize</span><span class="p">(</span><span class="n">reader</span><span class="p">)</span></div>

<div class="viewcode-block" id="Struct.read"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Struct.read">[docs]</a>	<span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">):</span>
		<span class="n">table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableClass</span><span class="p">()</span>
		<span class="n">table</span><span class="o">.</span><span class="n">decompile</span><span class="p">(</span><span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">table</span></div>

<div class="viewcode-block" id="Struct.write"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Struct.write">[docs]</a>	<span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">repeatIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="n">value</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">)</span></div>

<div class="viewcode-block" id="Struct.xmlWrite"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Struct.xmlWrite">[docs]</a>	<span class="k">def</span> <span class="nf">xmlWrite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmlWriter</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">attrs</span><span class="p">:</span>
				<span class="c1"># If there are attributes (probably index), then</span>
				<span class="c1"># don&#39;t drop this even if it&#39;s NULL.  It will mess</span>
				<span class="c1"># up the array indices of the containing element.</span>
				<span class="n">xmlWriter</span><span class="o">.</span><span class="n">simpletag</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">attrs</span> <span class="o">+</span> <span class="p">[(</span><span class="s2">&quot;empty&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
				<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">pass</span> <span class="c1"># NULL table, ignore</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">value</span><span class="o">.</span><span class="n">toXML</span><span class="p">(</span><span class="n">xmlWriter</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="Struct.xmlRead"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Struct.xmlRead">[docs]</a>	<span class="k">def</span> <span class="nf">xmlRead</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">font</span><span class="p">):</span>
		<span class="k">if</span> <span class="s2">&quot;empty&quot;</span> <span class="ow">in</span> <span class="n">attrs</span> <span class="ow">and</span> <span class="n">safeEval</span><span class="p">(</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;empty&quot;</span><span class="p">]):</span>
			<span class="k">return</span> <span class="kc">None</span>
		<span class="n">table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableClass</span><span class="p">()</span>
		<span class="n">Format</span> <span class="o">=</span> <span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Format&quot;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">Format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
			<span class="n">table</span><span class="o">.</span><span class="n">Format</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Format</span><span class="p">)</span>

		<span class="n">noPostRead</span> <span class="o">=</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="s1">&#39;postRead&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">noPostRead</span><span class="p">:</span>
			<span class="c1"># TODO Cache table.hasPropagated.</span>
			<span class="n">cleanPropagation</span> <span class="o">=</span> <span class="kc">False</span>
			<span class="k">for</span> <span class="n">conv</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">getConverters</span><span class="p">():</span>
				<span class="k">if</span> <span class="n">conv</span><span class="o">.</span><span class="n">isPropagated</span><span class="p">:</span>
					<span class="n">cleanPropagation</span> <span class="o">=</span> <span class="kc">True</span>
					<span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">font</span><span class="p">,</span> <span class="s1">&#39;_propagator&#39;</span><span class="p">):</span>
						<span class="n">font</span><span class="o">.</span><span class="n">_propagator</span> <span class="o">=</span> <span class="p">{}</span>
					<span class="n">propagator</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">_propagator</span>
					<span class="k">assert</span> <span class="n">conv</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">propagator</span><span class="p">,</span> <span class="p">(</span><span class="n">conv</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">propagator</span><span class="p">)</span>
					<span class="nb">setattr</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">conv</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
					<span class="n">propagator</span><span class="p">[</span><span class="n">conv</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">CountReference</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">,</span> <span class="n">conv</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

		<span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">content</span><span class="p">:</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
				<span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">content</span> <span class="o">=</span> <span class="n">element</span>
				<span class="n">table</span><span class="o">.</span><span class="n">fromXML</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">font</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">pass</span>

		<span class="n">table</span><span class="o">.</span><span class="n">populateDefaults</span><span class="p">(</span><span class="n">propagator</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">font</span><span class="p">,</span> <span class="s1">&#39;_propagator&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>

		<span class="k">if</span> <span class="n">noPostRead</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">cleanPropagation</span><span class="p">:</span>
				<span class="k">for</span> <span class="n">conv</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">getConverters</span><span class="p">():</span>
					<span class="k">if</span> <span class="n">conv</span><span class="o">.</span><span class="n">isPropagated</span><span class="p">:</span>
						<span class="n">propagator</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">_propagator</span>
						<span class="k">del</span> <span class="n">propagator</span><span class="p">[</span><span class="n">conv</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
						<span class="k">if</span> <span class="ow">not</span> <span class="n">propagator</span><span class="p">:</span>
							<span class="k">del</span> <span class="n">font</span><span class="o">.</span><span class="n">_propagator</span>

		<span class="k">return</span> <span class="n">table</span></div>

	<span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="s2">&quot;Struct of &quot;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tableClass</span><span class="p">)</span></div>


<div class="viewcode-block" id="StructWithLength"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.StructWithLength">[docs]</a><span class="k">class</span> <span class="nc">StructWithLength</span><span class="p">(</span><span class="n">Struct</span><span class="p">):</span>
<div class="viewcode-block" id="StructWithLength.read"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.StructWithLength.read">[docs]</a>	<span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">):</span>
		<span class="n">pos</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">pos</span>
		<span class="n">table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableClass</span><span class="p">()</span>
		<span class="n">table</span><span class="o">.</span><span class="n">decompile</span><span class="p">(</span><span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">)</span>
		<span class="n">reader</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="n">table</span><span class="o">.</span><span class="n">StructLength</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">table</span></div>

<div class="viewcode-block" id="StructWithLength.write"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.StructWithLength.write">[docs]</a>	<span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">repeatIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="k">for</span> <span class="n">convIndex</span><span class="p">,</span> <span class="n">conv</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">getConverters</span><span class="p">()):</span>
			<span class="k">if</span> <span class="n">conv</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;StructLength&quot;</span><span class="p">:</span>
				<span class="k">break</span>
		<span class="n">lengthIndex</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">writer</span><span class="o">.</span><span class="n">items</span><span class="p">)</span> <span class="o">+</span> <span class="n">convIndex</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">FormatSwitchingBaseTable</span><span class="p">):</span>
			<span class="n">lengthIndex</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># implicit Format field</span>
		<span class="n">deadbeef</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="mh">0xDE</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mh">0xDEAD</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span><span class="mh">0xDEADBEEF</span><span class="p">}[</span><span class="n">conv</span><span class="o">.</span><span class="n">staticSize</span><span class="p">]</span>

		<span class="n">before</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">getDataLength</span><span class="p">()</span>
		<span class="n">value</span><span class="o">.</span><span class="n">StructLength</span> <span class="o">=</span> <span class="n">deadbeef</span>
		<span class="n">value</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">)</span>
		<span class="n">length</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">getDataLength</span><span class="p">()</span> <span class="o">-</span> <span class="n">before</span>
		<span class="n">lengthWriter</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">getSubWriter</span><span class="p">()</span>
		<span class="n">conv</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">lengthWriter</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
		<span class="k">assert</span><span class="p">(</span><span class="n">writer</span><span class="o">.</span><span class="n">items</span><span class="p">[</span><span class="n">lengthIndex</span><span class="p">]</span> <span class="o">==</span>
		       <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xde\xad\xbe\xef</span><span class="s2">&quot;</span><span class="p">[:</span><span class="n">conv</span><span class="o">.</span><span class="n">staticSize</span><span class="p">])</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">items</span><span class="p">[</span><span class="n">lengthIndex</span><span class="p">]</span> <span class="o">=</span> <span class="n">lengthWriter</span><span class="o">.</span><span class="n">getAllData</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="Table"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Table">[docs]</a><span class="k">class</span> <span class="nc">Table</span><span class="p">(</span><span class="n">Struct</span><span class="p">):</span>

	<span class="n">longOffset</span> <span class="o">=</span> <span class="kc">False</span>
	<span class="n">staticSize</span> <span class="o">=</span> <span class="mi">2</span>

<div class="viewcode-block" id="Table.readOffset"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Table.readOffset">[docs]</a>	<span class="k">def</span> <span class="nf">readOffset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">reader</span><span class="o">.</span><span class="n">readUShort</span><span class="p">()</span></div>

<div class="viewcode-block" id="Table.writeNullOffset"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Table.writeNullOffset">[docs]</a>	<span class="k">def</span> <span class="nf">writeNullOffset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">longOffset</span><span class="p">:</span>
			<span class="n">writer</span><span class="o">.</span><span class="n">writeULong</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">writer</span><span class="o">.</span><span class="n">writeUShort</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="Table.read"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Table.read">[docs]</a>	<span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">):</span>
		<span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">readOffset</span><span class="p">(</span><span class="n">reader</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">offset</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
			<span class="k">return</span> <span class="kc">None</span>
		<span class="n">table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableClass</span><span class="p">()</span>
		<span class="n">reader</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">getSubReader</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">font</span><span class="o">.</span><span class="n">lazy</span><span class="p">:</span>
			<span class="n">table</span><span class="o">.</span><span class="n">reader</span> <span class="o">=</span> <span class="n">reader</span>
			<span class="n">table</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">font</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">table</span><span class="o">.</span><span class="n">decompile</span><span class="p">(</span><span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">table</span></div>

<div class="viewcode-block" id="Table.write"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.Table.write">[docs]</a>	<span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">repeatIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">writeNullOffset</span><span class="p">(</span><span class="n">writer</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">subWriter</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">getSubWriter</span><span class="p">()</span>
			<span class="n">subWriter</span><span class="o">.</span><span class="n">longOffset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">longOffset</span>
			<span class="n">subWriter</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
			<span class="k">if</span> <span class="n">repeatIndex</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
				<span class="n">subWriter</span><span class="o">.</span><span class="n">repeatIndex</span> <span class="o">=</span> <span class="n">repeatIndex</span>
			<span class="n">writer</span><span class="o">.</span><span class="n">writeSubTable</span><span class="p">(</span><span class="n">subWriter</span><span class="p">)</span>
			<span class="n">value</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">subWriter</span><span class="p">,</span> <span class="n">font</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="LTable"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.LTable">[docs]</a><span class="k">class</span> <span class="nc">LTable</span><span class="p">(</span><span class="n">Table</span><span class="p">):</span>

	<span class="n">longOffset</span> <span class="o">=</span> <span class="kc">True</span>
	<span class="n">staticSize</span> <span class="o">=</span> <span class="mi">4</span>

<div class="viewcode-block" id="LTable.readOffset"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.LTable.readOffset">[docs]</a>	<span class="k">def</span> <span class="nf">readOffset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">reader</span><span class="o">.</span><span class="n">readULong</span><span class="p">()</span></div></div>


<span class="c1"># TODO Clean / merge the SubTable and SubStruct</span>

<div class="viewcode-block" id="SubStruct"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.SubStruct">[docs]</a><span class="k">class</span> <span class="nc">SubStruct</span><span class="p">(</span><span class="n">Struct</span><span class="p">):</span>
<div class="viewcode-block" id="SubStruct.getConverter"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.SubStruct.getConverter">[docs]</a>	<span class="k">def</span> <span class="nf">getConverter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tableType</span><span class="p">,</span> <span class="n">lookupType</span><span class="p">):</span>
		<span class="n">tableClass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lookupTypes</span><span class="p">[</span><span class="n">tableType</span><span class="p">][</span><span class="n">lookupType</span><span class="p">]</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">repeat</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux</span><span class="p">,</span> <span class="n">tableClass</span><span class="p">)</span></div>

<div class="viewcode-block" id="SubStruct.xmlWrite"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.SubStruct.xmlWrite">[docs]</a>	<span class="k">def</span> <span class="nf">xmlWrite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmlWriter</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>
		<span class="nb">super</span><span class="p">(</span><span class="n">SubStruct</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">xmlWrite</span><span class="p">(</span><span class="n">xmlWriter</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="SubTable"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.SubTable">[docs]</a><span class="k">class</span> <span class="nc">SubTable</span><span class="p">(</span><span class="n">Table</span><span class="p">):</span>
<div class="viewcode-block" id="SubTable.getConverter"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.SubTable.getConverter">[docs]</a>	<span class="k">def</span> <span class="nf">getConverter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tableType</span><span class="p">,</span> <span class="n">lookupType</span><span class="p">):</span>
		<span class="n">tableClass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lookupTypes</span><span class="p">[</span><span class="n">tableType</span><span class="p">][</span><span class="n">lookupType</span><span class="p">]</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">repeat</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux</span><span class="p">,</span> <span class="n">tableClass</span><span class="p">)</span></div>

<div class="viewcode-block" id="SubTable.xmlWrite"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.SubTable.xmlWrite">[docs]</a>	<span class="k">def</span> <span class="nf">xmlWrite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmlWriter</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>
		<span class="nb">super</span><span class="p">(</span><span class="n">SubTable</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">xmlWrite</span><span class="p">(</span><span class="n">xmlWriter</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="ExtSubTable"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.ExtSubTable">[docs]</a><span class="k">class</span> <span class="nc">ExtSubTable</span><span class="p">(</span><span class="n">LTable</span><span class="p">,</span> <span class="n">SubTable</span><span class="p">):</span>

<div class="viewcode-block" id="ExtSubTable.write"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.ExtSubTable.write">[docs]</a>	<span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">repeatIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">Extension</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1"># actually, mere presence of the field flags it as an Ext Subtable writer.</span>
		<span class="n">Table</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">repeatIndex</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="FeatureParams"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.FeatureParams">[docs]</a><span class="k">class</span> <span class="nc">FeatureParams</span><span class="p">(</span><span class="n">Table</span><span class="p">):</span>
<div class="viewcode-block" id="FeatureParams.getConverter"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.FeatureParams.getConverter">[docs]</a>	<span class="k">def</span> <span class="nf">getConverter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">featureTag</span><span class="p">):</span>
		<span class="n">tableClass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">featureParamTypes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">featureTag</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">defaultFeatureParams</span><span class="p">)</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">repeat</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux</span><span class="p">,</span> <span class="n">tableClass</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="ValueFormat"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.ValueFormat">[docs]</a><span class="k">class</span> <span class="nc">ValueFormat</span><span class="p">(</span><span class="n">IntValue</span><span class="p">):</span>
	<span class="n">staticSize</span> <span class="o">=</span> <span class="mi">2</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">repeat</span><span class="p">,</span> <span class="n">aux</span><span class="p">,</span> <span class="n">tableClass</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="n">BaseConverter</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">repeat</span><span class="p">,</span> <span class="n">aux</span><span class="p">,</span> <span class="n">tableClass</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">which</span> <span class="o">=</span> <span class="s2">&quot;ValueFormat&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;2&quot;</span> <span class="k">if</span> <span class="n">name</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;2&quot;</span> <span class="k">else</span> <span class="s2">&quot;1&quot;</span><span class="p">)</span>
<div class="viewcode-block" id="ValueFormat.read"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.ValueFormat.read">[docs]</a>	<span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">):</span>
		<span class="nb">format</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">readUShort</span><span class="p">()</span>
		<span class="n">reader</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">which</span><span class="p">]</span> <span class="o">=</span> <span class="n">ValueRecordFactory</span><span class="p">(</span><span class="nb">format</span><span class="p">)</span>
		<span class="k">return</span> <span class="nb">format</span></div>
<div class="viewcode-block" id="ValueFormat.write"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.ValueFormat.write">[docs]</a>	<span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="nb">format</span><span class="p">,</span> <span class="n">repeatIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeUShort</span><span class="p">(</span><span class="nb">format</span><span class="p">)</span>
		<span class="n">writer</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">which</span><span class="p">]</span> <span class="o">=</span> <span class="n">ValueRecordFactory</span><span class="p">(</span><span class="nb">format</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="ValueRecord"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.ValueRecord">[docs]</a><span class="k">class</span> <span class="nc">ValueRecord</span><span class="p">(</span><span class="n">ValueFormat</span><span class="p">):</span>
<div class="viewcode-block" id="ValueRecord.getRecordSize"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.ValueRecord.getRecordSize">[docs]</a>	<span class="k">def</span> <span class="nf">getRecordSize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">):</span>
		<span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">reader</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">which</span><span class="p">])</span></div>
<div class="viewcode-block" id="ValueRecord.read"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.ValueRecord.read">[docs]</a>	<span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">reader</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">which</span><span class="p">]</span><span class="o">.</span><span class="n">readValueRecord</span><span class="p">(</span><span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">)</span></div>
<div class="viewcode-block" id="ValueRecord.write"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.ValueRecord.write">[docs]</a>	<span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">repeatIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="n">writer</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">which</span><span class="p">]</span><span class="o">.</span><span class="n">writeValueRecord</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>
<div class="viewcode-block" id="ValueRecord.xmlWrite"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.ValueRecord.xmlWrite">[docs]</a>	<span class="k">def</span> <span class="nf">xmlWrite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmlWriter</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
			<span class="k">pass</span>  <span class="c1"># NULL table, ignore</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">value</span><span class="o">.</span><span class="n">toXML</span><span class="p">(</span><span class="n">xmlWriter</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span></div>
<div class="viewcode-block" id="ValueRecord.xmlRead"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.ValueRecord.xmlRead">[docs]</a>	<span class="k">def</span> <span class="nf">xmlRead</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">font</span><span class="p">):</span>
		<span class="kn">from</span> <span class="nn">.otBase</span> <span class="k">import</span> <span class="n">ValueRecord</span>
		<span class="n">value</span> <span class="o">=</span> <span class="n">ValueRecord</span><span class="p">()</span>
		<span class="n">value</span><span class="o">.</span><span class="n">fromXML</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">font</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">value</span></div></div>


<div class="viewcode-block" id="AATLookup"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.AATLookup">[docs]</a><span class="k">class</span> <span class="nc">AATLookup</span><span class="p">(</span><span class="n">BaseConverter</span><span class="p">):</span>
	<span class="n">BIN_SEARCH_HEADER_SIZE</span> <span class="o">=</span> <span class="mi">10</span>

	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">repeat</span><span class="p">,</span> <span class="n">aux</span><span class="p">,</span> <span class="n">tableClass</span><span class="p">):</span>
		<span class="n">BaseConverter</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">repeat</span><span class="p">,</span> <span class="n">aux</span><span class="p">,</span> <span class="n">tableClass</span><span class="p">)</span>
		<span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tableClass</span><span class="p">,</span> <span class="n">SimpleValue</span><span class="p">):</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">converter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableClass</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Value&#39;</span><span class="p">,</span> <span class="n">repeat</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">aux</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">converter</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Value&#39;</span><span class="p">,</span> <span class="n">repeat</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">aux</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tableClass</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tableClass</span><span class="p">)</span>

<div class="viewcode-block" id="AATLookup.read"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.AATLookup.read">[docs]</a>	<span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">):</span>
		<span class="nb">format</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">readUShort</span><span class="p">()</span>
		<span class="k">if</span> <span class="nb">format</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">readFormat0</span><span class="p">(</span><span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">)</span>
		<span class="k">elif</span> <span class="nb">format</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">readFormat2</span><span class="p">(</span><span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">)</span>
		<span class="k">elif</span> <span class="nb">format</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">readFormat4</span><span class="p">(</span><span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">)</span>
		<span class="k">elif</span> <span class="nb">format</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">readFormat6</span><span class="p">(</span><span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">)</span>
		<span class="k">elif</span> <span class="nb">format</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">readFormat8</span><span class="p">(</span><span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;unsupported lookup format: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">format</span></div>

<div class="viewcode-block" id="AATLookup.write"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.AATLookup.write">[docs]</a>	<span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">repeatIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="n">values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">sorted</span><span class="p">([(</span><span class="n">font</span><span class="o">.</span><span class="n">getGlyphID</span><span class="p">(</span><span class="n">glyph</span><span class="p">),</span> <span class="n">val</span><span class="p">)</span>
		                      <span class="k">for</span> <span class="n">glyph</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">items</span><span class="p">()]))</span>
		<span class="c1"># TODO: Also implement format 4.</span>
		<span class="n">formats</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="p">[</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">buildFormat0</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">values</span><span class="p">),</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">buildFormat2</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">values</span><span class="p">),</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">buildFormat6</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">values</span><span class="p">),</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">buildFormat8</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">values</span><span class="p">),</span>
		<span class="p">])))</span>
		<span class="c1"># We use the format ID as secondary sort key to make the output</span>
		<span class="c1"># deterministic when multiple formats have same encoded size.</span>
		<span class="n">dataSize</span><span class="p">,</span> <span class="n">lookupFormat</span><span class="p">,</span> <span class="n">writeMethod</span> <span class="o">=</span> <span class="n">formats</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">pos</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">getDataLength</span><span class="p">()</span>
		<span class="n">writeMethod</span><span class="p">()</span>
		<span class="n">actualSize</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">getDataLength</span><span class="p">()</span> <span class="o">-</span> <span class="n">pos</span>
		<span class="k">assert</span> <span class="n">actualSize</span> <span class="o">==</span> <span class="n">dataSize</span><span class="p">,</span> <span class="p">(</span>
			<span class="s2">&quot;AATLookup format </span><span class="si">%d</span><span class="s2"> claimed to write </span><span class="si">%d</span><span class="s2"> bytes, but wrote </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span>
			<span class="p">(</span><span class="n">lookupFormat</span><span class="p">,</span> <span class="n">dataSize</span><span class="p">,</span> <span class="n">actualSize</span><span class="p">))</span></div>

<div class="viewcode-block" id="AATLookup.writeBinSearchHeader"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.AATLookup.writeBinSearchHeader">[docs]</a>	<span class="nd">@staticmethod</span>
	<span class="k">def</span> <span class="nf">writeBinSearchHeader</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">numUnits</span><span class="p">,</span> <span class="n">unitSize</span><span class="p">):</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeUShort</span><span class="p">(</span><span class="n">unitSize</span><span class="p">)</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeUShort</span><span class="p">(</span><span class="n">numUnits</span><span class="p">)</span>
		<span class="n">searchRange</span><span class="p">,</span> <span class="n">entrySelector</span><span class="p">,</span> <span class="n">rangeShift</span> <span class="o">=</span> \
			<span class="n">getSearchRange</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">numUnits</span><span class="p">,</span> <span class="n">itemSize</span><span class="o">=</span><span class="n">unitSize</span><span class="p">)</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeUShort</span><span class="p">(</span><span class="n">searchRange</span><span class="p">)</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeUShort</span><span class="p">(</span><span class="n">entrySelector</span><span class="p">)</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeUShort</span><span class="p">(</span><span class="n">rangeShift</span><span class="p">)</span></div>

<div class="viewcode-block" id="AATLookup.buildFormat0"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.AATLookup.buildFormat0">[docs]</a>	<span class="k">def</span> <span class="nf">buildFormat0</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
		<span class="n">numGlyphs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">font</span><span class="o">.</span><span class="n">getGlyphOrder</span><span class="p">())</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">!=</span> <span class="n">numGlyphs</span><span class="p">:</span>
			<span class="k">return</span> <span class="kc">None</span>
		<span class="n">valueSize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">converter</span><span class="o">.</span><span class="n">staticSize</span>
		<span class="k">return</span> <span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">numGlyphs</span> <span class="o">*</span> <span class="n">valueSize</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
			<span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">writeFormat0</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">values</span><span class="p">))</span></div>

<div class="viewcode-block" id="AATLookup.writeFormat0"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.AATLookup.writeFormat0">[docs]</a>	<span class="k">def</span> <span class="nf">writeFormat0</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeUShort</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">glyphID_</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">converter</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
				<span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
				<span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="n">repeatIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></div>

<div class="viewcode-block" id="AATLookup.buildFormat2"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.AATLookup.buildFormat2">[docs]</a>	<span class="k">def</span> <span class="nf">buildFormat2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
		<span class="n">segStart</span><span class="p">,</span> <span class="n">segValue</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">segEnd</span> <span class="o">=</span> <span class="n">segStart</span>
		<span class="n">segments</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">glyphID</span><span class="p">,</span> <span class="n">curValue</span> <span class="ow">in</span> <span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
			<span class="k">if</span> <span class="n">glyphID</span> <span class="o">!=</span> <span class="n">segEnd</span> <span class="o">+</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">curValue</span> <span class="o">!=</span> <span class="n">segValue</span><span class="p">:</span>
				<span class="n">segments</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">segStart</span><span class="p">,</span> <span class="n">segEnd</span><span class="p">,</span> <span class="n">segValue</span><span class="p">))</span>
				<span class="n">segStart</span> <span class="o">=</span> <span class="n">segEnd</span> <span class="o">=</span> <span class="n">glyphID</span>
				<span class="n">segValue</span> <span class="o">=</span> <span class="n">curValue</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">segEnd</span> <span class="o">=</span> <span class="n">glyphID</span>
		<span class="n">segments</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">segStart</span><span class="p">,</span> <span class="n">segEnd</span><span class="p">,</span> <span class="n">segValue</span><span class="p">))</span>
		<span class="n">valueSize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">converter</span><span class="o">.</span><span class="n">staticSize</span>
		<span class="n">numUnits</span><span class="p">,</span> <span class="n">unitSize</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">segments</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">valueSize</span> <span class="o">+</span> <span class="mi">4</span>
		<span class="k">return</span> <span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">BIN_SEARCH_HEADER_SIZE</span> <span class="o">+</span> <span class="n">numUnits</span> <span class="o">*</span> <span class="n">unitSize</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
		        <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">writeFormat2</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">segments</span><span class="p">))</span></div>

<div class="viewcode-block" id="AATLookup.writeFormat2"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.AATLookup.writeFormat2">[docs]</a>	<span class="k">def</span> <span class="nf">writeFormat2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">segments</span><span class="p">):</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeUShort</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">valueSize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">converter</span><span class="o">.</span><span class="n">staticSize</span>
		<span class="n">numUnits</span><span class="p">,</span> <span class="n">unitSize</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">segments</span><span class="p">),</span> <span class="n">valueSize</span> <span class="o">+</span> <span class="mi">4</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">writeBinSearchHeader</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">numUnits</span><span class="p">,</span> <span class="n">unitSize</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">firstGlyph</span><span class="p">,</span> <span class="n">lastGlyph</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">segments</span><span class="p">:</span>
			<span class="n">writer</span><span class="o">.</span><span class="n">writeUShort</span><span class="p">(</span><span class="n">lastGlyph</span><span class="p">)</span>
			<span class="n">writer</span><span class="o">.</span><span class="n">writeUShort</span><span class="p">(</span><span class="n">firstGlyph</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">converter</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
				<span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
				<span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="n">repeatIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeUShort</span><span class="p">(</span><span class="mh">0xFFFF</span><span class="p">)</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeUShort</span><span class="p">(</span><span class="mh">0xFFFF</span><span class="p">)</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeData</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span> <span class="o">*</span> <span class="n">valueSize</span><span class="p">)</span></div>

<div class="viewcode-block" id="AATLookup.buildFormat6"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.AATLookup.buildFormat6">[docs]</a>	<span class="k">def</span> <span class="nf">buildFormat6</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
		<span class="n">valueSize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">converter</span><span class="o">.</span><span class="n">staticSize</span>
		<span class="n">numUnits</span><span class="p">,</span> <span class="n">unitSize</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">),</span> <span class="n">valueSize</span> <span class="o">+</span> <span class="mi">2</span>
		<span class="k">return</span> <span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">BIN_SEARCH_HEADER_SIZE</span> <span class="o">+</span> <span class="p">(</span><span class="n">numUnits</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">unitSize</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span>
			<span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">writeFormat6</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">values</span><span class="p">))</span></div>

<div class="viewcode-block" id="AATLookup.writeFormat6"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.AATLookup.writeFormat6">[docs]</a>	<span class="k">def</span> <span class="nf">writeFormat6</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeUShort</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
		<span class="n">valueSize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">converter</span><span class="o">.</span><span class="n">staticSize</span>
		<span class="n">numUnits</span><span class="p">,</span> <span class="n">unitSize</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">),</span> <span class="n">valueSize</span> <span class="o">+</span> <span class="mi">2</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">writeBinSearchHeader</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">numUnits</span><span class="p">,</span> <span class="n">unitSize</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">glyphID</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
			<span class="n">writer</span><span class="o">.</span><span class="n">writeUShort</span><span class="p">(</span><span class="n">glyphID</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">converter</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
				<span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
				<span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="n">repeatIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeUShort</span><span class="p">(</span><span class="mh">0xFFFF</span><span class="p">)</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeData</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span> <span class="o">*</span> <span class="n">valueSize</span><span class="p">)</span></div>

<div class="viewcode-block" id="AATLookup.buildFormat8"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.AATLookup.buildFormat8">[docs]</a>	<span class="k">def</span> <span class="nf">buildFormat8</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
		<span class="n">minGlyphID</span><span class="p">,</span> <span class="n">maxGlyphID</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">!=</span> <span class="n">maxGlyphID</span> <span class="o">-</span> <span class="n">minGlyphID</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
			<span class="k">return</span> <span class="kc">None</span>
		<span class="n">valueSize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">converter</span><span class="o">.</span><span class="n">staticSize</span>
		<span class="k">return</span> <span class="p">(</span><span class="mi">6</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">*</span> <span class="n">valueSize</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
                        <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">writeFormat8</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">values</span><span class="p">))</span></div>

<div class="viewcode-block" id="AATLookup.writeFormat8"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.AATLookup.writeFormat8">[docs]</a>	<span class="k">def</span> <span class="nf">writeFormat8</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
		<span class="n">firstGlyphID</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeUShort</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeUShort</span><span class="p">(</span><span class="n">firstGlyphID</span><span class="p">)</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeUShort</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">))</span>
		<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">converter</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
				<span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
				<span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="n">repeatIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></div>

<div class="viewcode-block" id="AATLookup.readFormat0"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.AATLookup.readFormat0">[docs]</a>	<span class="k">def</span> <span class="nf">readFormat0</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">):</span>
		<span class="n">numGlyphs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">font</span><span class="o">.</span><span class="n">getGlyphOrder</span><span class="p">())</span>
		<span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">converter</span><span class="o">.</span><span class="n">readArray</span><span class="p">(</span>
			<span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="n">numGlyphs</span><span class="p">)</span>
		<span class="k">return</span> <span class="p">{</span><span class="n">font</span><span class="o">.</span><span class="n">getGlyphName</span><span class="p">(</span><span class="n">k</span><span class="p">):</span> <span class="n">value</span>
		        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">)}</span></div>

<div class="viewcode-block" id="AATLookup.readFormat2"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.AATLookup.readFormat2">[docs]</a>	<span class="k">def</span> <span class="nf">readFormat2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">):</span>
		<span class="n">mapping</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="n">pos</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">pos</span> <span class="o">-</span> <span class="mi">2</span>  <span class="c1"># start of table is at UShort for format</span>
		<span class="n">unitSize</span><span class="p">,</span> <span class="n">numUnits</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">readUShort</span><span class="p">(),</span> <span class="n">reader</span><span class="o">.</span><span class="n">readUShort</span><span class="p">()</span>
		<span class="k">assert</span> <span class="n">unitSize</span> <span class="o">&gt;=</span> <span class="mi">4</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">converter</span><span class="o">.</span><span class="n">staticSize</span><span class="p">,</span> <span class="n">unitSize</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numUnits</span><span class="p">):</span>
			<span class="n">reader</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">unitSize</span> <span class="o">+</span> <span class="mi">12</span><span class="p">)</span>
			<span class="n">last</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">readUShort</span><span class="p">()</span>
			<span class="n">first</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">readUShort</span><span class="p">()</span>
			<span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">converter</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">last</span> <span class="o">!=</span> <span class="mh">0xFFFF</span><span class="p">:</span>
				<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">last</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
					<span class="n">mapping</span><span class="p">[</span><span class="n">font</span><span class="o">.</span><span class="n">getGlyphName</span><span class="p">(</span><span class="n">k</span><span class="p">)]</span> <span class="o">=</span> <span class="n">value</span>
		<span class="k">return</span> <span class="n">mapping</span></div>

<div class="viewcode-block" id="AATLookup.readFormat4"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.AATLookup.readFormat4">[docs]</a>	<span class="k">def</span> <span class="nf">readFormat4</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">):</span>
		<span class="n">mapping</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="n">pos</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">pos</span> <span class="o">-</span> <span class="mi">2</span>  <span class="c1"># start of table is at UShort for format</span>
		<span class="n">unitSize</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">readUShort</span><span class="p">()</span>
		<span class="k">assert</span> <span class="n">unitSize</span> <span class="o">&gt;=</span> <span class="mi">6</span><span class="p">,</span> <span class="n">unitSize</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">reader</span><span class="o">.</span><span class="n">readUShort</span><span class="p">()):</span>
			<span class="n">reader</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">unitSize</span> <span class="o">+</span> <span class="mi">12</span><span class="p">)</span>
			<span class="n">last</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">readUShort</span><span class="p">()</span>
			<span class="n">first</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">readUShort</span><span class="p">()</span>
			<span class="n">offset</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">readUShort</span><span class="p">()</span>
			<span class="k">if</span> <span class="n">last</span> <span class="o">!=</span> <span class="mh">0xFFFF</span><span class="p">:</span>
				<span class="n">dataReader</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">getSubReader</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># relative to current position</span>
				<span class="n">dataReader</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="n">offset</span><span class="p">)</span>  <span class="c1"># relative to start of table</span>
				<span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">converter</span><span class="o">.</span><span class="n">readArray</span><span class="p">(</span>
					<span class="n">dataReader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
					<span class="n">count</span><span class="o">=</span><span class="n">last</span> <span class="o">-</span> <span class="n">first</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
				<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
					<span class="n">mapping</span><span class="p">[</span><span class="n">font</span><span class="o">.</span><span class="n">getGlyphName</span><span class="p">(</span><span class="n">first</span> <span class="o">+</span> <span class="n">k</span><span class="p">)]</span> <span class="o">=</span> <span class="n">v</span>
		<span class="k">return</span> <span class="n">mapping</span></div>

<div class="viewcode-block" id="AATLookup.readFormat6"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.AATLookup.readFormat6">[docs]</a>	<span class="k">def</span> <span class="nf">readFormat6</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">):</span>
		<span class="n">mapping</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="n">pos</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">pos</span> <span class="o">-</span> <span class="mi">2</span>  <span class="c1"># start of table is at UShort for format</span>
		<span class="n">unitSize</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">readUShort</span><span class="p">()</span>
		<span class="k">assert</span> <span class="n">unitSize</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">converter</span><span class="o">.</span><span class="n">staticSize</span><span class="p">,</span> <span class="n">unitSize</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">reader</span><span class="o">.</span><span class="n">readUShort</span><span class="p">()):</span>
			<span class="n">reader</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">unitSize</span> <span class="o">+</span> <span class="mi">12</span><span class="p">)</span>
			<span class="n">glyphID</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">readUShort</span><span class="p">()</span>
			<span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">converter</span><span class="o">.</span><span class="n">read</span><span class="p">(</span>
				<span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">glyphID</span> <span class="o">!=</span> <span class="mh">0xFFFF</span><span class="p">:</span>
				<span class="n">mapping</span><span class="p">[</span><span class="n">font</span><span class="o">.</span><span class="n">getGlyphName</span><span class="p">(</span><span class="n">glyphID</span><span class="p">)]</span> <span class="o">=</span> <span class="n">value</span>
		<span class="k">return</span> <span class="n">mapping</span></div>

<div class="viewcode-block" id="AATLookup.readFormat8"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.AATLookup.readFormat8">[docs]</a>	<span class="k">def</span> <span class="nf">readFormat8</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">):</span>
		<span class="n">first</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">readUShort</span><span class="p">()</span>
		<span class="n">count</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">readUShort</span><span class="p">()</span>
		<span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">converter</span><span class="o">.</span><span class="n">readArray</span><span class="p">(</span>
			<span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="n">count</span><span class="p">)</span>
		<span class="k">return</span> <span class="p">{</span><span class="n">font</span><span class="o">.</span><span class="n">getGlyphName</span><span class="p">(</span><span class="n">first</span> <span class="o">+</span> <span class="n">k</span><span class="p">):</span> <span class="n">value</span>
		        <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">)}</span></div>

<div class="viewcode-block" id="AATLookup.xmlRead"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.AATLookup.xmlRead">[docs]</a>	<span class="k">def</span> <span class="nf">xmlRead</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">font</span><span class="p">):</span>
		<span class="n">value</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">content</span><span class="p">:</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
				<span class="n">name</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">eltContent</span> <span class="o">=</span> <span class="n">element</span>
				<span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Lookup&quot;</span><span class="p">:</span>
					<span class="n">value</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="s2">&quot;glyph&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">converter</span><span class="o">.</span><span class="n">xmlRead</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">eltContent</span><span class="p">,</span> <span class="n">font</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">value</span></div>

<div class="viewcode-block" id="AATLookup.xmlWrite"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.AATLookup.xmlWrite">[docs]</a>	<span class="k">def</span> <span class="nf">xmlWrite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmlWriter</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">begintag</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">glyph</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">converter</span><span class="o">.</span><span class="n">xmlWrite</span><span class="p">(</span>
				<span class="n">xmlWriter</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span>
				<span class="n">name</span><span class="o">=</span><span class="s2">&quot;Lookup&quot;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;glyph&quot;</span><span class="p">,</span> <span class="n">glyph</span><span class="p">)])</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">endtag</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span></div></div>


<span class="c1"># The AAT &#39;ankr&#39; table has an unusual structure: An offset to an AATLookup</span>
<span class="c1"># followed by an offset to a glyph data table. Other than usual, the</span>
<span class="c1"># offsets in the AATLookup are not relative to the beginning of</span>
<span class="c1"># the beginning of the &#39;ankr&#39; table, but relative to the glyph data table.</span>
<span class="c1"># So, to find the anchor data for a glyph, one needs to add the offset</span>
<span class="c1"># to the data table to the offset found in the AATLookup, and then use</span>
<span class="c1"># the sum of these two offsets to find the actual data.</span>
<div class="viewcode-block" id="AATLookupWithDataOffset"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.AATLookupWithDataOffset">[docs]</a><span class="k">class</span> <span class="nc">AATLookupWithDataOffset</span><span class="p">(</span><span class="n">BaseConverter</span><span class="p">):</span>
<div class="viewcode-block" id="AATLookupWithDataOffset.read"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.AATLookupWithDataOffset.read">[docs]</a>	<span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">):</span>
		<span class="n">lookupOffset</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">readULong</span><span class="p">()</span>
		<span class="n">dataOffset</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">readULong</span><span class="p">()</span>
		<span class="n">lookupReader</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">getSubReader</span><span class="p">(</span><span class="n">lookupOffset</span><span class="p">)</span>
		<span class="n">lookup</span> <span class="o">=</span> <span class="n">AATLookup</span><span class="p">(</span><span class="s1">&#39;DataOffsets&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">UShort</span><span class="p">)</span>
		<span class="n">offsets</span> <span class="o">=</span> <span class="n">lookup</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">lookupReader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">for</span> <span class="n">glyph</span><span class="p">,</span> <span class="n">offset</span> <span class="ow">in</span> <span class="n">offsets</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
			<span class="n">dataReader</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">getSubReader</span><span class="p">(</span><span class="n">offset</span> <span class="o">+</span> <span class="n">dataOffset</span><span class="p">)</span>
			<span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableClass</span><span class="p">()</span>
			<span class="n">item</span><span class="o">.</span><span class="n">decompile</span><span class="p">(</span><span class="n">dataReader</span><span class="p">,</span> <span class="n">font</span><span class="p">)</span>
			<span class="n">result</span><span class="p">[</span><span class="n">glyph</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span>
		<span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="AATLookupWithDataOffset.write"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.AATLookupWithDataOffset.write">[docs]</a>	<span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">repeatIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="c1"># We do not work with OTTableWriter sub-writers because</span>
		<span class="c1"># the offsets in our AATLookup are relative to our data</span>
		<span class="c1"># table, for which we need to provide an offset value itself.</span>
		<span class="c1"># It might have been possible to somehow make a kludge for</span>
		<span class="c1"># performing this indirect offset computation directly inside</span>
		<span class="c1"># OTTableWriter. But this would have made the internal logic</span>
		<span class="c1"># of OTTableWriter even more complex than it already is,</span>
		<span class="c1"># so we decided to roll our own offset computation for the</span>
		<span class="c1"># contents of the AATLookup and associated data table.</span>
		<span class="n">offsetByGlyph</span><span class="p">,</span> <span class="n">offsetByData</span><span class="p">,</span> <span class="n">dataLen</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{},</span> <span class="mi">0</span>
		<span class="n">compiledData</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">glyph</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">font</span><span class="o">.</span><span class="n">getGlyphID</span><span class="p">):</span>
			<span class="n">subWriter</span> <span class="o">=</span> <span class="n">OTTableWriter</span><span class="p">()</span>
			<span class="n">value</span><span class="p">[</span><span class="n">glyph</span><span class="p">]</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">subWriter</span><span class="p">,</span> <span class="n">font</span><span class="p">)</span>
			<span class="n">data</span> <span class="o">=</span> <span class="n">subWriter</span><span class="o">.</span><span class="n">getAllData</span><span class="p">()</span>
			<span class="n">offset</span> <span class="o">=</span> <span class="n">offsetByData</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">offset</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
				<span class="n">offset</span> <span class="o">=</span> <span class="n">dataLen</span>
				<span class="n">dataLen</span> <span class="o">=</span> <span class="n">dataLen</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
				<span class="n">offsetByData</span><span class="p">[</span><span class="n">data</span><span class="p">]</span> <span class="o">=</span> <span class="n">offset</span>
				<span class="n">compiledData</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
			<span class="n">offsetByGlyph</span><span class="p">[</span><span class="n">glyph</span><span class="p">]</span> <span class="o">=</span> <span class="n">offset</span>
		<span class="c1"># For calculating the offsets to our AATLookup and data table,</span>
		<span class="c1"># we can use the regular OTTableWriter infrastructure.</span>
		<span class="n">lookupWriter</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">getSubWriter</span><span class="p">()</span>
		<span class="n">lookupWriter</span><span class="o">.</span><span class="n">longOffset</span> <span class="o">=</span> <span class="kc">True</span>
		<span class="n">lookup</span> <span class="o">=</span> <span class="n">AATLookup</span><span class="p">(</span><span class="s1">&#39;DataOffsets&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">UShort</span><span class="p">)</span>
		<span class="n">lookup</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">lookupWriter</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="n">offsetByGlyph</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

		<span class="n">dataWriter</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">getSubWriter</span><span class="p">()</span>
		<span class="n">dataWriter</span><span class="o">.</span><span class="n">longOffset</span> <span class="o">=</span> <span class="kc">True</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeSubTable</span><span class="p">(</span><span class="n">lookupWriter</span><span class="p">)</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeSubTable</span><span class="p">(</span><span class="n">dataWriter</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">compiledData</span><span class="p">:</span>
			<span class="n">dataWriter</span><span class="o">.</span><span class="n">writeData</span><span class="p">(</span><span class="n">d</span><span class="p">)</span></div>

<div class="viewcode-block" id="AATLookupWithDataOffset.xmlRead"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.AATLookupWithDataOffset.xmlRead">[docs]</a>	<span class="k">def</span> <span class="nf">xmlRead</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">font</span><span class="p">):</span>
		<span class="n">lookup</span> <span class="o">=</span> <span class="n">AATLookup</span><span class="p">(</span><span class="s1">&#39;DataOffsets&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableClass</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">lookup</span><span class="o">.</span><span class="n">xmlRead</span><span class="p">(</span><span class="n">attrs</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">font</span><span class="p">)</span></div>

<div class="viewcode-block" id="AATLookupWithDataOffset.xmlWrite"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.AATLookupWithDataOffset.xmlWrite">[docs]</a>	<span class="k">def</span> <span class="nf">xmlWrite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmlWriter</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>
		<span class="n">lookup</span> <span class="o">=</span> <span class="n">AATLookup</span><span class="p">(</span><span class="s1">&#39;DataOffsets&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableClass</span><span class="p">)</span>
		<span class="n">lookup</span><span class="o">.</span><span class="n">xmlWrite</span><span class="p">(</span><span class="n">xmlWriter</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="MorxSubtableConverter"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.MorxSubtableConverter">[docs]</a><span class="k">class</span> <span class="nc">MorxSubtableConverter</span><span class="p">(</span><span class="n">BaseConverter</span><span class="p">):</span>
	<span class="n">_PROCESSING_ORDERS</span> <span class="o">=</span> <span class="p">{</span>
		<span class="c1"># bits 30 and 28 of morx.CoverageFlags; see morx spec</span>
		<span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span> <span class="s2">&quot;LayoutOrder&quot;</span><span class="p">,</span>
		<span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span> <span class="s2">&quot;ReversedLayoutOrder&quot;</span><span class="p">,</span>
		<span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span> <span class="s2">&quot;LogicalOrder&quot;</span><span class="p">,</span>
		<span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span> <span class="s2">&quot;ReversedLogicalOrder&quot;</span><span class="p">,</span>
	<span class="p">}</span>

	<span class="n">_PROCESSING_ORDERS_REVERSED</span> <span class="o">=</span> <span class="p">{</span>
		<span class="n">val</span><span class="p">:</span> <span class="n">key</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">_PROCESSING_ORDERS</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
	<span class="p">}</span>

	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">repeat</span><span class="p">,</span> <span class="n">aux</span><span class="p">):</span>
		<span class="n">BaseConverter</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">repeat</span><span class="p">,</span> <span class="n">aux</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">_setTextDirectionFromCoverageFlags</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="n">subtable</span><span class="p">):</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="mh">0x20</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
			<span class="n">subtable</span><span class="o">.</span><span class="n">TextDirection</span> <span class="o">=</span> <span class="s2">&quot;Any&quot;</span>
		<span class="k">elif</span> <span class="p">(</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="mh">0x80</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
			<span class="n">subtable</span><span class="o">.</span><span class="n">TextDirection</span> <span class="o">=</span> <span class="s2">&quot;Vertical&quot;</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">subtable</span><span class="o">.</span><span class="n">TextDirection</span> <span class="o">=</span> <span class="s2">&quot;Horizontal&quot;</span>

<div class="viewcode-block" id="MorxSubtableConverter.read"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.MorxSubtableConverter.read">[docs]</a>	<span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">):</span>
		<span class="n">pos</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">pos</span>
		<span class="n">m</span> <span class="o">=</span> <span class="n">MorxSubtable</span><span class="p">()</span>
		<span class="n">m</span><span class="o">.</span><span class="n">StructLength</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">readULong</span><span class="p">()</span>
		<span class="n">flags</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">readUInt8</span><span class="p">()</span>
		<span class="n">orderKey</span> <span class="o">=</span> <span class="p">((</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="mh">0x40</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="mh">0x10</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">m</span><span class="o">.</span><span class="n">ProcessingOrder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_PROCESSING_ORDERS</span><span class="p">[</span><span class="n">orderKey</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_setTextDirectionFromCoverageFlags</span><span class="p">(</span><span class="n">flags</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
		<span class="n">m</span><span class="o">.</span><span class="n">Reserved</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">readUShort</span><span class="p">()</span>
		<span class="n">m</span><span class="o">.</span><span class="n">Reserved</span> <span class="o">|=</span> <span class="p">(</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="mh">0xF</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span>
		<span class="n">m</span><span class="o">.</span><span class="n">MorphType</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">readUInt8</span><span class="p">()</span>
		<span class="n">m</span><span class="o">.</span><span class="n">SubFeatureFlags</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">readULong</span><span class="p">()</span>
		<span class="n">tableClass</span> <span class="o">=</span> <span class="n">lookupTypes</span><span class="p">[</span><span class="s2">&quot;morx&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">MorphType</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">tableClass</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
			<span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;unsupported &#39;morx&#39; lookup type </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span>
			               <span class="n">m</span><span class="o">.</span><span class="n">MorphType</span><span class="p">)</span>
		<span class="c1"># To decode AAT ligatures, we need to know the subtable size.</span>
		<span class="c1"># The easiest way to pass this along is to create a new reader</span>
		<span class="c1"># that works on just the subtable as its data.</span>
		<span class="n">headerLength</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">pos</span> <span class="o">-</span> <span class="n">pos</span>
		<span class="n">data</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">data</span><span class="p">[</span>
			<span class="n">reader</span><span class="o">.</span><span class="n">pos</span>
			<span class="p">:</span> <span class="n">reader</span><span class="o">.</span><span class="n">pos</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="n">StructLength</span> <span class="o">-</span> <span class="n">headerLength</span><span class="p">]</span>
		<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="n">m</span><span class="o">.</span><span class="n">StructLength</span> <span class="o">-</span> <span class="n">headerLength</span>
		<span class="n">subReader</span> <span class="o">=</span> <span class="n">OTTableReader</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">tableTag</span><span class="o">=</span><span class="n">reader</span><span class="o">.</span><span class="n">tableTag</span><span class="p">)</span>
		<span class="n">m</span><span class="o">.</span><span class="n">SubStruct</span> <span class="o">=</span> <span class="n">tableClass</span><span class="p">()</span>
		<span class="n">m</span><span class="o">.</span><span class="n">SubStruct</span><span class="o">.</span><span class="n">decompile</span><span class="p">(</span><span class="n">subReader</span><span class="p">,</span> <span class="n">font</span><span class="p">)</span>
		<span class="n">reader</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="n">StructLength</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">m</span></div>

<div class="viewcode-block" id="MorxSubtableConverter.xmlWrite"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.MorxSubtableConverter.xmlWrite">[docs]</a>	<span class="k">def</span> <span class="nf">xmlWrite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmlWriter</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">begintag</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="s2">&quot;StructLength=</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">value</span><span class="o">.</span><span class="n">StructLength</span><span class="p">)</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">simpletag</span><span class="p">(</span><span class="s2">&quot;TextDirection&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="o">.</span><span class="n">TextDirection</span><span class="p">)</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">simpletag</span><span class="p">(</span><span class="s2">&quot;ProcessingOrder&quot;</span><span class="p">,</span>
		                    <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="o">.</span><span class="n">ProcessingOrder</span><span class="p">)</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">Reserved</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
			<span class="n">xmlWriter</span><span class="o">.</span><span class="n">simpletag</span><span class="p">(</span><span class="s2">&quot;Reserved&quot;</span><span class="p">,</span>
			                    <span class="n">value</span><span class="o">=</span><span class="s2">&quot;0x</span><span class="si">%04x</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">value</span><span class="o">.</span><span class="n">Reserved</span><span class="p">)</span>
			<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="s2">&quot;MorphType=</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">value</span><span class="o">.</span><span class="n">MorphType</span><span class="p">)</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">simpletag</span><span class="p">(</span><span class="s2">&quot;SubFeatureFlags&quot;</span><span class="p">,</span>
		                    <span class="n">value</span><span class="o">=</span><span class="s2">&quot;0x</span><span class="si">%08x</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">value</span><span class="o">.</span><span class="n">SubFeatureFlags</span><span class="p">)</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span>
		<span class="n">value</span><span class="o">.</span><span class="n">SubStruct</span><span class="o">.</span><span class="n">toXML</span><span class="p">(</span><span class="n">xmlWriter</span><span class="p">,</span> <span class="n">font</span><span class="p">)</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">endtag</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span></div>

<div class="viewcode-block" id="MorxSubtableConverter.xmlRead"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.MorxSubtableConverter.xmlRead">[docs]</a>	<span class="k">def</span> <span class="nf">xmlRead</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">font</span><span class="p">):</span>
		<span class="n">m</span> <span class="o">=</span> <span class="n">MorxSubtable</span><span class="p">()</span>
		<span class="n">covFlags</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="n">m</span><span class="o">.</span><span class="n">Reserved</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="k">for</span> <span class="n">eltName</span><span class="p">,</span> <span class="n">eltAttrs</span><span class="p">,</span> <span class="n">eltContent</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">(</span><span class="n">istuple</span><span class="p">,</span> <span class="n">content</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">eltName</span> <span class="o">==</span> <span class="s2">&quot;CoverageFlags&quot;</span><span class="p">:</span>
				<span class="c1"># Only in XML from old versions of fonttools.</span>
				<span class="n">covFlags</span> <span class="o">=</span> <span class="n">safeEval</span><span class="p">(</span><span class="n">eltAttrs</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">])</span>
				<span class="n">orderKey</span> <span class="o">=</span> <span class="p">((</span><span class="n">covFlags</span> <span class="o">&amp;</span> <span class="mh">0x40</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span>
				            <span class="p">(</span><span class="n">covFlags</span> <span class="o">&amp;</span> <span class="mh">0x10</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
				<span class="n">m</span><span class="o">.</span><span class="n">ProcessingOrder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_PROCESSING_ORDERS</span><span class="p">[</span>
					<span class="n">orderKey</span><span class="p">]</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_setTextDirectionFromCoverageFlags</span><span class="p">(</span>
					<span class="n">covFlags</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
			<span class="k">elif</span> <span class="n">eltName</span> <span class="o">==</span> <span class="s2">&quot;ProcessingOrder&quot;</span><span class="p">:</span>
				<span class="n">m</span><span class="o">.</span><span class="n">ProcessingOrder</span> <span class="o">=</span> <span class="n">eltAttrs</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
				<span class="k">assert</span> <span class="n">m</span><span class="o">.</span><span class="n">ProcessingOrder</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_PROCESSING_ORDERS_REVERSED</span><span class="p">,</span> <span class="s2">&quot;unknown ProcessingOrder: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">m</span><span class="o">.</span><span class="n">ProcessingOrder</span>
			<span class="k">elif</span> <span class="n">eltName</span> <span class="o">==</span> <span class="s2">&quot;TextDirection&quot;</span><span class="p">:</span>
				<span class="n">m</span><span class="o">.</span><span class="n">TextDirection</span> <span class="o">=</span> <span class="n">eltAttrs</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
				<span class="k">assert</span> <span class="n">m</span><span class="o">.</span><span class="n">TextDirection</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;Horizontal&quot;</span><span class="p">,</span> <span class="s2">&quot;Vertical&quot;</span><span class="p">,</span> <span class="s2">&quot;Any&quot;</span><span class="p">},</span> <span class="s2">&quot;unknown TextDirection </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">m</span><span class="o">.</span><span class="n">TextDirection</span>
			<span class="k">elif</span> <span class="n">eltName</span> <span class="o">==</span> <span class="s2">&quot;Reserved&quot;</span><span class="p">:</span>
				<span class="n">m</span><span class="o">.</span><span class="n">Reserved</span> <span class="o">=</span> <span class="n">safeEval</span><span class="p">(</span><span class="n">eltAttrs</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">])</span>
			<span class="k">elif</span> <span class="n">eltName</span> <span class="o">==</span> <span class="s2">&quot;SubFeatureFlags&quot;</span><span class="p">:</span>
				<span class="n">m</span><span class="o">.</span><span class="n">SubFeatureFlags</span> <span class="o">=</span> <span class="n">safeEval</span><span class="p">(</span><span class="n">eltAttrs</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">])</span>
			<span class="k">elif</span> <span class="n">eltName</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;Morph&quot;</span><span class="p">):</span>
				<span class="n">m</span><span class="o">.</span><span class="n">fromXML</span><span class="p">(</span><span class="n">eltName</span><span class="p">,</span> <span class="n">eltAttrs</span><span class="p">,</span> <span class="n">eltContent</span><span class="p">,</span> <span class="n">font</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="n">eltName</span>
		<span class="n">m</span><span class="o">.</span><span class="n">Reserved</span> <span class="o">=</span> <span class="p">(</span><span class="n">covFlags</span> <span class="o">&amp;</span> <span class="mh">0xF</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span> <span class="o">|</span> <span class="n">m</span><span class="o">.</span><span class="n">Reserved</span>
		<span class="k">return</span> <span class="n">m</span></div>

<div class="viewcode-block" id="MorxSubtableConverter.write"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.MorxSubtableConverter.write">[docs]</a>	<span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">repeatIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="n">covFlags</span> <span class="o">=</span> <span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">Reserved</span> <span class="o">&amp;</span> <span class="mh">0x000F0000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span>
		<span class="n">reverseOrder</span><span class="p">,</span> <span class="n">logicalOrder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_PROCESSING_ORDERS_REVERSED</span><span class="p">[</span>
			<span class="n">value</span><span class="o">.</span><span class="n">ProcessingOrder</span><span class="p">]</span>
		<span class="n">covFlags</span> <span class="o">|=</span> <span class="mh">0x80</span> <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">TextDirection</span> <span class="o">==</span> <span class="s2">&quot;Vertical&quot;</span> <span class="k">else</span> <span class="mi">0</span>
		<span class="n">covFlags</span> <span class="o">|=</span> <span class="mh">0x40</span> <span class="k">if</span> <span class="n">reverseOrder</span> <span class="k">else</span> <span class="mi">0</span>
		<span class="n">covFlags</span> <span class="o">|=</span> <span class="mh">0x20</span> <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">TextDirection</span> <span class="o">==</span> <span class="s2">&quot;Any&quot;</span> <span class="k">else</span> <span class="mi">0</span>
		<span class="n">covFlags</span> <span class="o">|=</span> <span class="mh">0x10</span> <span class="k">if</span> <span class="n">logicalOrder</span> <span class="k">else</span> <span class="mi">0</span>
		<span class="n">value</span><span class="o">.</span><span class="n">CoverageFlags</span> <span class="o">=</span> <span class="n">covFlags</span>
		<span class="n">lengthIndex</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">writer</span><span class="o">.</span><span class="n">items</span><span class="p">)</span>
		<span class="n">before</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">getDataLength</span><span class="p">()</span>
		<span class="n">value</span><span class="o">.</span><span class="n">StructLength</span> <span class="o">=</span> <span class="mh">0xdeadbeef</span>
		<span class="c1"># The high nibble of value.Reserved is actuallly encoded</span>
		<span class="c1"># into coverageFlags, so we need to clear it here.</span>
		<span class="n">origReserved</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">Reserved</span> <span class="c1"># including high nibble</span>
		<span class="n">value</span><span class="o">.</span><span class="n">Reserved</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">Reserved</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span> <span class="c1"># without high nibble</span>
		<span class="n">value</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">)</span>
		<span class="n">value</span><span class="o">.</span><span class="n">Reserved</span> <span class="o">=</span> <span class="n">origReserved</span>  <span class="c1"># restore original value</span>
		<span class="k">assert</span> <span class="n">writer</span><span class="o">.</span><span class="n">items</span><span class="p">[</span><span class="n">lengthIndex</span><span class="p">]</span> <span class="o">==</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xde\xad\xbe\xef</span><span class="s2">&quot;</span>
		<span class="n">length</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">getDataLength</span><span class="p">()</span> <span class="o">-</span> <span class="n">before</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">items</span><span class="p">[</span><span class="n">lengthIndex</span><span class="p">]</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s2">&quot;&gt;L&quot;</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span></div></div>


<span class="c1"># https://developer.apple.com/fonts/TrueType-Reference-Manual/RM06/Chap6Tables.html#ExtendedStateHeader</span>
<span class="c1"># TODO: Untangle the implementation of the various lookup-specific formats.</span>
<div class="viewcode-block" id="STXHeader"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.STXHeader">[docs]</a><span class="k">class</span> <span class="nc">STXHeader</span><span class="p">(</span><span class="n">BaseConverter</span><span class="p">):</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">repeat</span><span class="p">,</span> <span class="n">aux</span><span class="p">,</span> <span class="n">tableClass</span><span class="p">):</span>
		<span class="n">BaseConverter</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">repeat</span><span class="p">,</span> <span class="n">aux</span><span class="p">,</span> <span class="n">tableClass</span><span class="p">)</span>
		<span class="k">assert</span> <span class="nb">issubclass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tableClass</span><span class="p">,</span> <span class="n">AATAction</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">classLookup</span> <span class="o">=</span> <span class="n">AATLookup</span><span class="p">(</span><span class="s2">&quot;GlyphClasses&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">UShort</span><span class="p">)</span>
		<span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tableClass</span><span class="p">,</span> <span class="n">ContextualMorphAction</span><span class="p">):</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">perGlyphLookup</span> <span class="o">=</span> <span class="n">AATLookup</span><span class="p">(</span><span class="s2">&quot;PerGlyphLookup&quot;</span><span class="p">,</span>
			                                <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">GlyphID</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">perGlyphLookup</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="STXHeader.read"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.STXHeader.read">[docs]</a>	<span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">):</span>
		<span class="n">table</span> <span class="o">=</span> <span class="n">AATStateTable</span><span class="p">()</span>
		<span class="n">pos</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">pos</span>
		<span class="n">classTableReader</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">getSubReader</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
		<span class="n">stateArrayReader</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">getSubReader</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
		<span class="n">entryTableReader</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">getSubReader</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
		<span class="n">actionReader</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="n">ligaturesReader</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="n">table</span><span class="o">.</span><span class="n">GlyphClassCount</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">readULong</span><span class="p">()</span>
		<span class="n">classTableReader</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="n">reader</span><span class="o">.</span><span class="n">readULong</span><span class="p">())</span>
		<span class="n">stateArrayReader</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="n">reader</span><span class="o">.</span><span class="n">readULong</span><span class="p">())</span>
		<span class="n">entryTableReader</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="n">reader</span><span class="o">.</span><span class="n">readULong</span><span class="p">())</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">perGlyphLookup</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
			<span class="n">perGlyphTableReader</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">getSubReader</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
			<span class="n">perGlyphTableReader</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="n">reader</span><span class="o">.</span><span class="n">readULong</span><span class="p">())</span>
		<span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tableClass</span><span class="p">,</span> <span class="n">LigatureMorphAction</span><span class="p">):</span>
			<span class="n">actionReader</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">getSubReader</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
			<span class="n">actionReader</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="n">reader</span><span class="o">.</span><span class="n">readULong</span><span class="p">())</span>
			<span class="n">ligComponentReader</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">getSubReader</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
			<span class="n">ligComponentReader</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="n">reader</span><span class="o">.</span><span class="n">readULong</span><span class="p">())</span>
			<span class="n">ligaturesReader</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">getSubReader</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
			<span class="n">ligaturesReader</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="n">reader</span><span class="o">.</span><span class="n">readULong</span><span class="p">())</span>
			<span class="n">numLigComponents</span> <span class="o">=</span> <span class="p">(</span><span class="n">ligaturesReader</span><span class="o">.</span><span class="n">pos</span>
			                    <span class="o">-</span> <span class="n">ligComponentReader</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
			<span class="k">assert</span> <span class="n">numLigComponents</span> <span class="o">&gt;=</span> <span class="mi">0</span>
			<span class="n">table</span><span class="o">.</span><span class="n">LigComponents</span> <span class="o">=</span> \
				<span class="n">ligComponentReader</span><span class="o">.</span><span class="n">readUShortArray</span><span class="p">(</span><span class="n">numLigComponents</span><span class="p">)</span>
			<span class="n">table</span><span class="o">.</span><span class="n">Ligatures</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_readLigatures</span><span class="p">(</span><span class="n">ligaturesReader</span><span class="p">,</span> <span class="n">font</span><span class="p">)</span>
		<span class="k">elif</span> <span class="nb">issubclass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tableClass</span><span class="p">,</span> <span class="n">InsertionMorphAction</span><span class="p">):</span>
			<span class="n">actionReader</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">getSubReader</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
			<span class="n">actionReader</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="n">reader</span><span class="o">.</span><span class="n">readULong</span><span class="p">())</span>
		<span class="n">table</span><span class="o">.</span><span class="n">GlyphClasses</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classLookup</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">classTableReader</span><span class="p">,</span>
		                                           <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">)</span>
		<span class="n">numStates</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">entryTableReader</span><span class="o">.</span><span class="n">pos</span> <span class="o">-</span> <span class="n">stateArrayReader</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span>
		                 <span class="o">/</span> <span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">GlyphClassCount</span> <span class="o">*</span> <span class="mi">2</span><span class="p">))</span>
		<span class="k">for</span> <span class="n">stateIndex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numStates</span><span class="p">):</span>
			<span class="n">state</span> <span class="o">=</span> <span class="n">AATState</span><span class="p">()</span>
			<span class="n">table</span><span class="o">.</span><span class="n">States</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
			<span class="k">for</span> <span class="n">glyphClass</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">GlyphClassCount</span><span class="p">):</span>
				<span class="n">entryIndex</span> <span class="o">=</span> <span class="n">stateArrayReader</span><span class="o">.</span><span class="n">readUShort</span><span class="p">()</span>
				<span class="n">state</span><span class="o">.</span><span class="n">Transitions</span><span class="p">[</span><span class="n">glyphClass</span><span class="p">]</span> <span class="o">=</span> \
					<span class="bp">self</span><span class="o">.</span><span class="n">_readTransition</span><span class="p">(</span><span class="n">entryTableReader</span><span class="p">,</span>
					                     <span class="n">entryIndex</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span>
					                     <span class="n">actionReader</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">perGlyphLookup</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
			<span class="n">table</span><span class="o">.</span><span class="n">PerGlyphLookups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_readPerGlyphLookups</span><span class="p">(</span>
				<span class="n">table</span><span class="p">,</span> <span class="n">perGlyphTableReader</span><span class="p">,</span> <span class="n">font</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">table</span></div>

	<span class="k">def</span> <span class="nf">_readTransition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">entryIndex</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">actionReader</span><span class="p">):</span>
		<span class="n">transition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableClass</span><span class="p">()</span>
		<span class="n">entryReader</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">getSubReader</span><span class="p">(</span>
			<span class="n">reader</span><span class="o">.</span><span class="n">pos</span> <span class="o">+</span> <span class="n">entryIndex</span> <span class="o">*</span> <span class="n">transition</span><span class="o">.</span><span class="n">staticSize</span><span class="p">)</span>
		<span class="n">transition</span><span class="o">.</span><span class="n">decompile</span><span class="p">(</span><span class="n">entryReader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">actionReader</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">transition</span>

	<span class="k">def</span> <span class="nf">_readLigatures</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">):</span>
		<span class="n">limit</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">reader</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
		<span class="n">numLigatureGlyphs</span> <span class="o">=</span> <span class="p">(</span><span class="n">limit</span> <span class="o">-</span> <span class="n">reader</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
		<span class="k">return</span> <span class="p">[</span><span class="n">font</span><span class="o">.</span><span class="n">getGlyphName</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
		        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">reader</span><span class="o">.</span><span class="n">readUShortArray</span><span class="p">(</span><span class="n">numLigatureGlyphs</span><span class="p">)]</span>

	<span class="k">def</span> <span class="nf">_countPerGlyphLookups</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">):</span>
		<span class="c1"># Somewhat annoyingly, the morx table does not encode</span>
		<span class="c1"># the size of the per-glyph table. So we need to find</span>
		<span class="c1"># the maximum value that MorphActions use as index</span>
		<span class="c1"># into this table.</span>
		<span class="n">numLookups</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">States</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">state</span><span class="o">.</span><span class="n">Transitions</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">ContextualMorphAction</span><span class="p">):</span>
					<span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">MarkIndex</span> <span class="o">!=</span> <span class="mh">0xFFFF</span><span class="p">:</span>
						<span class="n">numLookups</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
							<span class="n">numLookups</span><span class="p">,</span>
							<span class="n">t</span><span class="o">.</span><span class="n">MarkIndex</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
					<span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">CurrentIndex</span> <span class="o">!=</span> <span class="mh">0xFFFF</span><span class="p">:</span>
						<span class="n">numLookups</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
							<span class="n">numLookups</span><span class="p">,</span>
							<span class="n">t</span><span class="o">.</span><span class="n">CurrentIndex</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">numLookups</span>

	<span class="k">def</span> <span class="nf">_readPerGlyphLookups</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">):</span>
		<span class="n">pos</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">pos</span>
		<span class="n">lookups</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_countPerGlyphLookups</span><span class="p">(</span><span class="n">table</span><span class="p">)):</span>
			<span class="n">lookupReader</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">getSubReader</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
			<span class="n">lookupReader</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="n">reader</span><span class="o">.</span><span class="n">readULong</span><span class="p">())</span>
			<span class="n">lookups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">perGlyphLookup</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">lookupReader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="p">{}))</span>
		<span class="k">return</span> <span class="n">lookups</span>

<div class="viewcode-block" id="STXHeader.write"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.STXHeader.write">[docs]</a>	<span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">repeatIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="n">glyphClassWriter</span> <span class="o">=</span> <span class="n">OTTableWriter</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">classLookup</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">glyphClassWriter</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span>
		                       <span class="n">value</span><span class="o">.</span><span class="n">GlyphClasses</span><span class="p">,</span> <span class="n">repeatIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
		<span class="n">glyphClassData</span> <span class="o">=</span> <span class="n">pad</span><span class="p">(</span><span class="n">glyphClassWriter</span><span class="o">.</span><span class="n">getAllData</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
		<span class="n">glyphClassCount</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">GlyphClasses</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">+</span> <span class="mi">1</span>
		<span class="n">glyphClassTableOffset</span> <span class="o">=</span> <span class="mi">16</span>  <span class="c1"># size of STXHeader</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">perGlyphLookup</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
			<span class="n">glyphClassTableOffset</span> <span class="o">+=</span> <span class="mi">4</span>

		<span class="n">glyphClassTableOffset</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableClass</span><span class="o">.</span><span class="n">actionHeaderSize</span>
		<span class="n">actionData</span><span class="p">,</span> <span class="n">actionIndex</span> <span class="o">=</span> \
			<span class="bp">self</span><span class="o">.</span><span class="n">tableClass</span><span class="o">.</span><span class="n">compileActions</span><span class="p">(</span><span class="n">font</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">States</span><span class="p">)</span>
		<span class="n">stateArrayData</span><span class="p">,</span> <span class="n">entryTableData</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compileStates</span><span class="p">(</span>
			<span class="n">font</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">States</span><span class="p">,</span> <span class="n">glyphClassCount</span><span class="p">,</span> <span class="n">actionIndex</span><span class="p">)</span>
		<span class="n">stateArrayOffset</span> <span class="o">=</span> <span class="n">glyphClassTableOffset</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">glyphClassData</span><span class="p">)</span>
		<span class="n">entryTableOffset</span> <span class="o">=</span> <span class="n">stateArrayOffset</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">stateArrayData</span><span class="p">)</span>
		<span class="n">perGlyphOffset</span> <span class="o">=</span> <span class="n">entryTableOffset</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">entryTableData</span><span class="p">)</span>
		<span class="n">perGlyphData</span> <span class="o">=</span> \
			<span class="n">pad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_compilePerGlyphLookups</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">font</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">actionData</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
			<span class="n">actionOffset</span> <span class="o">=</span> <span class="n">entryTableOffset</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">entryTableData</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">actionOffset</span> <span class="o">=</span> <span class="kc">None</span>

		<span class="n">ligaturesOffset</span><span class="p">,</span> <span class="n">ligComponentsOffset</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
		<span class="n">ligComponentsData</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compileLigComponents</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">font</span><span class="p">)</span>
		<span class="n">ligaturesData</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compileLigatures</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">font</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">ligComponentsData</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
			<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">perGlyphData</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
			<span class="n">ligComponentsOffset</span> <span class="o">=</span> <span class="n">actionOffset</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">actionData</span><span class="p">)</span>
			<span class="n">ligaturesOffset</span> <span class="o">=</span> <span class="n">ligComponentsOffset</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">ligComponentsData</span><span class="p">)</span>

		<span class="n">writer</span><span class="o">.</span><span class="n">writeULong</span><span class="p">(</span><span class="n">glyphClassCount</span><span class="p">)</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeULong</span><span class="p">(</span><span class="n">glyphClassTableOffset</span><span class="p">)</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeULong</span><span class="p">(</span><span class="n">stateArrayOffset</span><span class="p">)</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeULong</span><span class="p">(</span><span class="n">entryTableOffset</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">perGlyphLookup</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
			<span class="n">writer</span><span class="o">.</span><span class="n">writeULong</span><span class="p">(</span><span class="n">perGlyphOffset</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">actionOffset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
			<span class="n">writer</span><span class="o">.</span><span class="n">writeULong</span><span class="p">(</span><span class="n">actionOffset</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">ligComponentsOffset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
			<span class="n">writer</span><span class="o">.</span><span class="n">writeULong</span><span class="p">(</span><span class="n">ligComponentsOffset</span><span class="p">)</span>
			<span class="n">writer</span><span class="o">.</span><span class="n">writeULong</span><span class="p">(</span><span class="n">ligaturesOffset</span><span class="p">)</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeData</span><span class="p">(</span><span class="n">glyphClassData</span><span class="p">)</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeData</span><span class="p">(</span><span class="n">stateArrayData</span><span class="p">)</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeData</span><span class="p">(</span><span class="n">entryTableData</span><span class="p">)</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeData</span><span class="p">(</span><span class="n">perGlyphData</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">actionData</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
			<span class="n">writer</span><span class="o">.</span><span class="n">writeData</span><span class="p">(</span><span class="n">actionData</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">ligComponentsData</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
			<span class="n">writer</span><span class="o">.</span><span class="n">writeData</span><span class="p">(</span><span class="n">ligComponentsData</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">ligaturesData</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
			<span class="n">writer</span><span class="o">.</span><span class="n">writeData</span><span class="p">(</span><span class="n">ligaturesData</span><span class="p">)</span></div>

	<span class="k">def</span> <span class="nf">_compileStates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">states</span><span class="p">,</span> <span class="n">glyphClassCount</span><span class="p">,</span> <span class="n">actionIndex</span><span class="p">):</span>
		<span class="n">stateArrayWriter</span> <span class="o">=</span> <span class="n">OTTableWriter</span><span class="p">()</span>
		<span class="n">entries</span><span class="p">,</span> <span class="n">entryIDs</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">{}</span>
		<span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">states</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">glyphClass</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">glyphClassCount</span><span class="p">):</span>
				<span class="n">transition</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">Transitions</span><span class="p">[</span><span class="n">glyphClass</span><span class="p">]</span>
				<span class="n">entryWriter</span> <span class="o">=</span> <span class="n">OTTableWriter</span><span class="p">()</span>
				<span class="n">transition</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">entryWriter</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span>
				                   <span class="n">actionIndex</span><span class="p">)</span>
				<span class="n">entryData</span> <span class="o">=</span> <span class="n">entryWriter</span><span class="o">.</span><span class="n">getAllData</span><span class="p">()</span>
				<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">entryData</span><span class="p">)</span>  <span class="o">==</span> <span class="n">transition</span><span class="o">.</span><span class="n">staticSize</span><span class="p">,</span> <span class="p">(</span> \
					<span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> has staticSize </span><span class="si">%d</span><span class="s2">, &quot;</span>
					<span class="s2">&quot;but actually wrote </span><span class="si">%d</span><span class="s2"> bytes&quot;</span> <span class="o">%</span> <span class="p">(</span>
						<span class="nb">repr</span><span class="p">(</span><span class="n">transition</span><span class="p">),</span>
						<span class="n">transition</span><span class="o">.</span><span class="n">staticSize</span><span class="p">,</span>
						<span class="nb">len</span><span class="p">(</span><span class="n">entryData</span><span class="p">)))</span>
				<span class="n">entryIndex</span> <span class="o">=</span> <span class="n">entryIDs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">entryData</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">entryIndex</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
					<span class="n">entryIndex</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>
					<span class="n">entryIDs</span><span class="p">[</span><span class="n">entryData</span><span class="p">]</span> <span class="o">=</span> <span class="n">entryIndex</span>
					<span class="n">entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entryData</span><span class="p">)</span>
				<span class="n">stateArrayWriter</span><span class="o">.</span><span class="n">writeUShort</span><span class="p">(</span><span class="n">entryIndex</span><span class="p">)</span>
		<span class="n">stateArrayData</span> <span class="o">=</span> <span class="n">pad</span><span class="p">(</span><span class="n">stateArrayWriter</span><span class="o">.</span><span class="n">getAllData</span><span class="p">(),</span> <span class="mi">4</span><span class="p">)</span>
		<span class="n">entryTableData</span> <span class="o">=</span> <span class="n">pad</span><span class="p">(</span><span class="n">bytesjoin</span><span class="p">(</span><span class="n">entries</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">stateArrayData</span><span class="p">,</span> <span class="n">entryTableData</span>

	<span class="k">def</span> <span class="nf">_compilePerGlyphLookups</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">font</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">perGlyphLookup</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
			<span class="k">return</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
		<span class="n">numLookups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_countPerGlyphLookups</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
		<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">PerGlyphLookups</span><span class="p">)</span> <span class="o">==</span> <span class="n">numLookups</span><span class="p">,</span> <span class="p">(</span>
			<span class="s2">&quot;len(AATStateTable.PerGlyphLookups) is </span><span class="si">%d</span><span class="s2">, &quot;</span>
			<span class="s2">&quot;but the actions inside the table refer to </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span>
				<span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">PerGlyphLookups</span><span class="p">),</span> <span class="n">numLookups</span><span class="p">))</span>
		<span class="n">writer</span> <span class="o">=</span> <span class="n">OTTableWriter</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">lookup</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">PerGlyphLookups</span><span class="p">:</span>
			<span class="n">lookupWriter</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">getSubWriter</span><span class="p">()</span>
			<span class="n">lookupWriter</span><span class="o">.</span><span class="n">longOffset</span> <span class="o">=</span> <span class="kc">True</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">perGlyphLookup</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">lookupWriter</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span>
			                          <span class="p">{},</span> <span class="n">lookup</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
			<span class="n">writer</span><span class="o">.</span><span class="n">writeSubTable</span><span class="p">(</span><span class="n">lookupWriter</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">writer</span><span class="o">.</span><span class="n">getAllData</span><span class="p">()</span>

	<span class="k">def</span> <span class="nf">_compileLigComponents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">font</span><span class="p">):</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="s2">&quot;LigComponents&quot;</span><span class="p">):</span>
			<span class="k">return</span> <span class="kc">None</span>
		<span class="n">writer</span> <span class="o">=</span> <span class="n">OTTableWriter</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">LigComponents</span><span class="p">:</span>
			<span class="n">writer</span><span class="o">.</span><span class="n">writeUShort</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">writer</span><span class="o">.</span><span class="n">getAllData</span><span class="p">()</span>

	<span class="k">def</span> <span class="nf">_compileLigatures</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">font</span><span class="p">):</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="s2">&quot;Ligatures&quot;</span><span class="p">):</span>
			<span class="k">return</span> <span class="kc">None</span>
		<span class="n">writer</span> <span class="o">=</span> <span class="n">OTTableWriter</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">glyphName</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">Ligatures</span><span class="p">:</span>
			<span class="n">writer</span><span class="o">.</span><span class="n">writeUShort</span><span class="p">(</span><span class="n">font</span><span class="o">.</span><span class="n">getGlyphID</span><span class="p">(</span><span class="n">glyphName</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">writer</span><span class="o">.</span><span class="n">getAllData</span><span class="p">()</span>

<div class="viewcode-block" id="STXHeader.xmlWrite"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.STXHeader.xmlWrite">[docs]</a>	<span class="k">def</span> <span class="nf">xmlWrite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmlWriter</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">begintag</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="s2">&quot;GlyphClassCount=</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="n">value</span><span class="o">.</span><span class="n">GlyphClassCount</span><span class="p">)</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">g</span><span class="p">,</span> <span class="n">klass</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">GlyphClasses</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
			<span class="n">xmlWriter</span><span class="o">.</span><span class="n">simpletag</span><span class="p">(</span><span class="s2">&quot;GlyphClass&quot;</span><span class="p">,</span> <span class="n">glyph</span><span class="o">=</span><span class="n">g</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">klass</span><span class="p">)</span>
			<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">stateIndex</span><span class="p">,</span> <span class="n">state</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">States</span><span class="p">):</span>
			<span class="n">xmlWriter</span><span class="o">.</span><span class="n">begintag</span><span class="p">(</span><span class="s2">&quot;State&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">stateIndex</span><span class="p">)</span>
			<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span>
			<span class="k">for</span> <span class="n">glyphClass</span><span class="p">,</span> <span class="n">trans</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">Transitions</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
				<span class="n">trans</span><span class="o">.</span><span class="n">toXML</span><span class="p">(</span><span class="n">xmlWriter</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">font</span><span class="p">,</span>
				            <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;onGlyphClass&quot;</span><span class="p">:</span> <span class="n">glyphClass</span><span class="p">},</span>
				            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Transition&quot;</span><span class="p">)</span>
			<span class="n">xmlWriter</span><span class="o">.</span><span class="n">endtag</span><span class="p">(</span><span class="s2">&quot;State&quot;</span><span class="p">)</span>
			<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">lookup</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">PerGlyphLookups</span><span class="p">):</span>
			<span class="n">xmlWriter</span><span class="o">.</span><span class="n">begintag</span><span class="p">(</span><span class="s2">&quot;PerGlyphLookup&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
			<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span>
			<span class="k">for</span> <span class="n">glyph</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">lookup</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
				<span class="n">xmlWriter</span><span class="o">.</span><span class="n">simpletag</span><span class="p">(</span><span class="s2">&quot;Lookup&quot;</span><span class="p">,</span> <span class="n">glyph</span><span class="o">=</span><span class="n">glyph</span><span class="p">,</span>
				                    <span class="n">value</span><span class="o">=</span><span class="n">val</span><span class="p">)</span>
				<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span>
			<span class="n">xmlWriter</span><span class="o">.</span><span class="n">endtag</span><span class="p">(</span><span class="s2">&quot;PerGlyphLookup&quot;</span><span class="p">)</span>
			<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span>
		<span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;LigComponents&quot;</span><span class="p">):</span>
			<span class="n">xmlWriter</span><span class="o">.</span><span class="n">begintag</span><span class="p">(</span><span class="s2">&quot;LigComponents&quot;</span><span class="p">)</span>
			<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span>
			<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;LigComponents&quot;</span><span class="p">)):</span>
				<span class="n">xmlWriter</span><span class="o">.</span><span class="n">simpletag</span><span class="p">(</span><span class="s2">&quot;LigComponent&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
				                    <span class="n">value</span><span class="o">=</span><span class="n">val</span><span class="p">)</span>
				<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span>
			<span class="n">xmlWriter</span><span class="o">.</span><span class="n">endtag</span><span class="p">(</span><span class="s2">&quot;LigComponents&quot;</span><span class="p">)</span>
			<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_xmlWriteLigatures</span><span class="p">(</span><span class="n">xmlWriter</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">endtag</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span></div>

	<span class="k">def</span> <span class="nf">_xmlWriteLigatures</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmlWriter</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;Ligatures&quot;</span><span class="p">):</span>
			<span class="k">return</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">begintag</span><span class="p">(</span><span class="s2">&quot;Ligatures&quot;</span><span class="p">)</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;Ligatures&quot;</span><span class="p">)):</span>
			<span class="n">xmlWriter</span><span class="o">.</span><span class="n">simpletag</span><span class="p">(</span><span class="s2">&quot;Ligature&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">glyph</span><span class="o">=</span><span class="n">g</span><span class="p">)</span>
			<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">endtag</span><span class="p">(</span><span class="s2">&quot;Ligatures&quot;</span><span class="p">)</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span>

<div class="viewcode-block" id="STXHeader.xmlRead"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.STXHeader.xmlRead">[docs]</a>	<span class="k">def</span> <span class="nf">xmlRead</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">font</span><span class="p">):</span>
		<span class="n">table</span> <span class="o">=</span> <span class="n">AATStateTable</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">eltName</span><span class="p">,</span> <span class="n">eltAttrs</span><span class="p">,</span> <span class="n">eltContent</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">(</span><span class="n">istuple</span><span class="p">,</span> <span class="n">content</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">eltName</span> <span class="o">==</span> <span class="s2">&quot;GlyphClass&quot;</span><span class="p">:</span>
				<span class="n">glyph</span> <span class="o">=</span> <span class="n">eltAttrs</span><span class="p">[</span><span class="s2">&quot;glyph&quot;</span><span class="p">]</span>
				<span class="n">value</span> <span class="o">=</span> <span class="n">eltAttrs</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
				<span class="n">table</span><span class="o">.</span><span class="n">GlyphClasses</span><span class="p">[</span><span class="n">glyph</span><span class="p">]</span> <span class="o">=</span> <span class="n">safeEval</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
			<span class="k">elif</span> <span class="n">eltName</span> <span class="o">==</span> <span class="s2">&quot;State&quot;</span><span class="p">:</span>
				<span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xmlReadState</span><span class="p">(</span><span class="n">eltAttrs</span><span class="p">,</span> <span class="n">eltContent</span><span class="p">,</span> <span class="n">font</span><span class="p">)</span>
				<span class="n">table</span><span class="o">.</span><span class="n">States</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
			<span class="k">elif</span> <span class="n">eltName</span> <span class="o">==</span> <span class="s2">&quot;PerGlyphLookup&quot;</span><span class="p">:</span>
				<span class="n">lookup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">perGlyphLookup</span><span class="o">.</span><span class="n">xmlRead</span><span class="p">(</span>
					<span class="n">eltAttrs</span><span class="p">,</span> <span class="n">eltContent</span><span class="p">,</span> <span class="n">font</span><span class="p">)</span>
				<span class="n">table</span><span class="o">.</span><span class="n">PerGlyphLookups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lookup</span><span class="p">)</span>
			<span class="k">elif</span> <span class="n">eltName</span> <span class="o">==</span> <span class="s2">&quot;LigComponents&quot;</span><span class="p">:</span>
				<span class="n">table</span><span class="o">.</span><span class="n">LigComponents</span> <span class="o">=</span> \
					<span class="bp">self</span><span class="o">.</span><span class="n">_xmlReadLigComponents</span><span class="p">(</span>
						<span class="n">eltAttrs</span><span class="p">,</span> <span class="n">eltContent</span><span class="p">,</span> <span class="n">font</span><span class="p">)</span>
			<span class="k">elif</span> <span class="n">eltName</span> <span class="o">==</span> <span class="s2">&quot;Ligatures&quot;</span><span class="p">:</span>
				<span class="n">table</span><span class="o">.</span><span class="n">Ligatures</span> <span class="o">=</span> \
					<span class="bp">self</span><span class="o">.</span><span class="n">_xmlReadLigatures</span><span class="p">(</span>
						<span class="n">eltAttrs</span><span class="p">,</span> <span class="n">eltContent</span><span class="p">,</span> <span class="n">font</span><span class="p">)</span>
		<span class="n">table</span><span class="o">.</span><span class="n">GlyphClassCount</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">GlyphClasses</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">+</span> <span class="mi">1</span>
		<span class="k">return</span> <span class="n">table</span></div>

	<span class="k">def</span> <span class="nf">_xmlReadState</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">font</span><span class="p">):</span>
		<span class="n">state</span> <span class="o">=</span> <span class="n">AATState</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">eltName</span><span class="p">,</span> <span class="n">eltAttrs</span><span class="p">,</span> <span class="n">eltContent</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">(</span><span class="n">istuple</span><span class="p">,</span> <span class="n">content</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">eltName</span> <span class="o">==</span> <span class="s2">&quot;Transition&quot;</span><span class="p">:</span>
				<span class="n">glyphClass</span> <span class="o">=</span> <span class="n">safeEval</span><span class="p">(</span><span class="n">eltAttrs</span><span class="p">[</span><span class="s2">&quot;onGlyphClass&quot;</span><span class="p">])</span>
				<span class="n">transition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableClass</span><span class="p">()</span>
				<span class="n">transition</span><span class="o">.</span><span class="n">fromXML</span><span class="p">(</span><span class="n">eltName</span><span class="p">,</span> <span class="n">eltAttrs</span><span class="p">,</span>
				                   <span class="n">eltContent</span><span class="p">,</span> <span class="n">font</span><span class="p">)</span>
				<span class="n">state</span><span class="o">.</span><span class="n">Transitions</span><span class="p">[</span><span class="n">glyphClass</span><span class="p">]</span> <span class="o">=</span> <span class="n">transition</span>
		<span class="k">return</span> <span class="n">state</span>

	<span class="k">def</span> <span class="nf">_xmlReadLigComponents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">font</span><span class="p">):</span>
		<span class="n">ligComponents</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">eltName</span><span class="p">,</span> <span class="n">eltAttrs</span><span class="p">,</span> <span class="n">_eltContent</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">(</span><span class="n">istuple</span><span class="p">,</span> <span class="n">content</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">eltName</span> <span class="o">==</span> <span class="s2">&quot;LigComponent&quot;</span><span class="p">:</span>
				<span class="n">ligComponents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
					<span class="n">safeEval</span><span class="p">(</span><span class="n">eltAttrs</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]))</span>
		<span class="k">return</span> <span class="n">ligComponents</span>

	<span class="k">def</span> <span class="nf">_xmlReadLigatures</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">font</span><span class="p">):</span>
		<span class="n">ligs</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">eltName</span><span class="p">,</span> <span class="n">eltAttrs</span><span class="p">,</span> <span class="n">_eltContent</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">(</span><span class="n">istuple</span><span class="p">,</span> <span class="n">content</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">eltName</span> <span class="o">==</span> <span class="s2">&quot;Ligature&quot;</span><span class="p">:</span>
				<span class="n">ligs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">eltAttrs</span><span class="p">[</span><span class="s2">&quot;glyph&quot;</span><span class="p">])</span>
		<span class="k">return</span> <span class="n">ligs</span></div>


<div class="viewcode-block" id="CIDGlyphMap"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.CIDGlyphMap">[docs]</a><span class="k">class</span> <span class="nc">CIDGlyphMap</span><span class="p">(</span><span class="n">BaseConverter</span><span class="p">):</span>
<div class="viewcode-block" id="CIDGlyphMap.read"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.CIDGlyphMap.read">[docs]</a>	<span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">):</span>
		<span class="n">numCIDs</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">readUShort</span><span class="p">()</span>
		<span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">for</span> <span class="n">cid</span><span class="p">,</span> <span class="n">glyphID</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">reader</span><span class="o">.</span><span class="n">readUShortArray</span><span class="p">(</span><span class="n">numCIDs</span><span class="p">)):</span>
			<span class="k">if</span> <span class="n">glyphID</span> <span class="o">!=</span> <span class="mh">0xFFFF</span><span class="p">:</span>
				<span class="n">result</span><span class="p">[</span><span class="n">cid</span><span class="p">]</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">getGlyphName</span><span class="p">(</span><span class="n">glyphID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="CIDGlyphMap.write"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.CIDGlyphMap.write">[docs]</a>	<span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">repeatIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="n">items</span> <span class="o">=</span> <span class="p">{</span><span class="n">cid</span><span class="p">:</span> <span class="n">font</span><span class="o">.</span><span class="n">getGlyphID</span><span class="p">(</span><span class="n">glyph</span><span class="p">)</span>
		         <span class="k">for</span> <span class="n">cid</span><span class="p">,</span> <span class="n">glyph</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
		<span class="n">count</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">items</span> <span class="k">else</span> <span class="mi">0</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeUShort</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">cid</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">count</span><span class="p">):</span>
			<span class="n">writer</span><span class="o">.</span><span class="n">writeUShort</span><span class="p">(</span><span class="n">items</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cid</span><span class="p">,</span> <span class="mh">0xFFFF</span><span class="p">))</span></div>

<div class="viewcode-block" id="CIDGlyphMap.xmlRead"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.CIDGlyphMap.xmlRead">[docs]</a>	<span class="k">def</span> <span class="nf">xmlRead</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">font</span><span class="p">):</span>
		<span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">for</span> <span class="n">eName</span><span class="p">,</span> <span class="n">eAttrs</span><span class="p">,</span> <span class="n">_eContent</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">(</span><span class="n">istuple</span><span class="p">,</span> <span class="n">content</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">eName</span> <span class="o">==</span> <span class="s2">&quot;CID&quot;</span><span class="p">:</span>
				<span class="n">result</span><span class="p">[</span><span class="n">safeEval</span><span class="p">(</span><span class="n">eAttrs</span><span class="p">[</span><span class="s2">&quot;cid&quot;</span><span class="p">])]</span> <span class="o">=</span> \
					<span class="n">eAttrs</span><span class="p">[</span><span class="s2">&quot;glyph&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="CIDGlyphMap.xmlWrite"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.CIDGlyphMap.xmlWrite">[docs]</a>	<span class="k">def</span> <span class="nf">xmlWrite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmlWriter</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">begintag</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">cid</span><span class="p">,</span> <span class="n">glyph</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
			<span class="k">if</span> <span class="n">glyph</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">glyph</span> <span class="o">!=</span> <span class="mh">0xFFFF</span><span class="p">:</span>
				<span class="n">xmlWriter</span><span class="o">.</span><span class="n">simpletag</span><span class="p">(</span>
					<span class="s2">&quot;CID&quot;</span><span class="p">,</span> <span class="n">cid</span><span class="o">=</span><span class="n">cid</span><span class="p">,</span> <span class="n">glyph</span><span class="o">=</span><span class="n">glyph</span><span class="p">)</span>
				<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">endtag</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="GlyphCIDMap"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.GlyphCIDMap">[docs]</a><span class="k">class</span> <span class="nc">GlyphCIDMap</span><span class="p">(</span><span class="n">BaseConverter</span><span class="p">):</span>
<div class="viewcode-block" id="GlyphCIDMap.read"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.GlyphCIDMap.read">[docs]</a>	<span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">):</span>
		<span class="n">glyphOrder</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">getGlyphOrder</span><span class="p">()</span>
		<span class="n">count</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">readUShort</span><span class="p">()</span>
		<span class="n">cids</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">readUShortArray</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">glyphOrder</span><span class="p">):</span>
			<span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;GlyphCIDMap has </span><span class="si">%d</span><span class="s2"> elements, &quot;</span>
			            <span class="s2">&quot;but the font has only </span><span class="si">%d</span><span class="s2"> glyphs; &quot;</span>
			            <span class="s2">&quot;ignoring the rest&quot;</span> <span class="o">%</span>
			             <span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">glyphOrder</span><span class="p">)))</span>
		<span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">for</span> <span class="n">glyphID</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cids</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">glyphOrder</span><span class="p">))):</span>
			<span class="n">cid</span> <span class="o">=</span> <span class="n">cids</span><span class="p">[</span><span class="n">glyphID</span><span class="p">]</span>
			<span class="k">if</span> <span class="n">cid</span> <span class="o">!=</span> <span class="mh">0xFFFF</span><span class="p">:</span>
				<span class="n">result</span><span class="p">[</span><span class="n">glyphOrder</span><span class="p">[</span><span class="n">glyphID</span><span class="p">]]</span> <span class="o">=</span> <span class="n">cid</span>
		<span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="GlyphCIDMap.write"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.GlyphCIDMap.write">[docs]</a>	<span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">repeatIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="n">items</span> <span class="o">=</span> <span class="p">{</span><span class="n">font</span><span class="o">.</span><span class="n">getGlyphID</span><span class="p">(</span><span class="n">g</span><span class="p">):</span> <span class="n">cid</span>
		         <span class="k">for</span> <span class="n">g</span><span class="p">,</span> <span class="n">cid</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
		         <span class="k">if</span> <span class="n">cid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">cid</span> <span class="o">!=</span> <span class="mh">0xFFFF</span><span class="p">}</span>
		<span class="n">count</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">items</span> <span class="k">else</span> <span class="mi">0</span>
		<span class="n">writer</span><span class="o">.</span><span class="n">writeUShort</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">glyphID</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">count</span><span class="p">):</span>
			<span class="n">writer</span><span class="o">.</span><span class="n">writeUShort</span><span class="p">(</span><span class="n">items</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">glyphID</span><span class="p">,</span> <span class="mh">0xFFFF</span><span class="p">))</span></div>

<div class="viewcode-block" id="GlyphCIDMap.xmlRead"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.GlyphCIDMap.xmlRead">[docs]</a>	<span class="k">def</span> <span class="nf">xmlRead</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">font</span><span class="p">):</span>
		<span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">for</span> <span class="n">eName</span><span class="p">,</span> <span class="n">eAttrs</span><span class="p">,</span> <span class="n">_eContent</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">(</span><span class="n">istuple</span><span class="p">,</span> <span class="n">content</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">eName</span> <span class="o">==</span> <span class="s2">&quot;CID&quot;</span><span class="p">:</span>
				<span class="n">result</span><span class="p">[</span><span class="n">eAttrs</span><span class="p">[</span><span class="s2">&quot;glyph&quot;</span><span class="p">]]</span> <span class="o">=</span> \
					<span class="n">safeEval</span><span class="p">(</span><span class="n">eAttrs</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">])</span>
		<span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="GlyphCIDMap.xmlWrite"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.GlyphCIDMap.xmlWrite">[docs]</a>	<span class="k">def</span> <span class="nf">xmlWrite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmlWriter</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">begintag</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">glyph</span><span class="p">,</span> <span class="n">cid</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
			<span class="k">if</span> <span class="n">cid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">cid</span> <span class="o">!=</span> <span class="mh">0xFFFF</span><span class="p">:</span>
				<span class="n">xmlWriter</span><span class="o">.</span><span class="n">simpletag</span><span class="p">(</span>
					<span class="s2">&quot;CID&quot;</span><span class="p">,</span> <span class="n">glyph</span><span class="o">=</span><span class="n">glyph</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">cid</span><span class="p">)</span>
				<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">endtag</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="DeltaValue"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.DeltaValue">[docs]</a><span class="k">class</span> <span class="nc">DeltaValue</span><span class="p">(</span><span class="n">BaseConverter</span><span class="p">):</span>

<div class="viewcode-block" id="DeltaValue.read"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.DeltaValue.read">[docs]</a>	<span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">):</span>
		<span class="n">StartSize</span> <span class="o">=</span> <span class="n">tableDict</span><span class="p">[</span><span class="s2">&quot;StartSize&quot;</span><span class="p">]</span>
		<span class="n">EndSize</span> <span class="o">=</span> <span class="n">tableDict</span><span class="p">[</span><span class="s2">&quot;EndSize&quot;</span><span class="p">]</span>
		<span class="n">DeltaFormat</span> <span class="o">=</span> <span class="n">tableDict</span><span class="p">[</span><span class="s2">&quot;DeltaFormat&quot;</span><span class="p">]</span>
		<span class="k">assert</span> <span class="n">DeltaFormat</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="s2">&quot;illegal DeltaFormat&quot;</span>
		<span class="n">nItems</span> <span class="o">=</span> <span class="n">EndSize</span> <span class="o">-</span> <span class="n">StartSize</span> <span class="o">+</span> <span class="mi">1</span>
		<span class="n">nBits</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">DeltaFormat</span>
		<span class="n">minusOffset</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">nBits</span>
		<span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">nBits</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
		<span class="n">signMask</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">nBits</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

		<span class="n">DeltaValue</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">tmp</span><span class="p">,</span> <span class="n">shift</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nItems</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">shift</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
				<span class="n">tmp</span><span class="p">,</span> <span class="n">shift</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">readUShort</span><span class="p">(),</span> <span class="mi">16</span>
			<span class="n">shift</span> <span class="o">=</span> <span class="n">shift</span> <span class="o">-</span> <span class="n">nBits</span>
			<span class="n">value</span> <span class="o">=</span> <span class="p">(</span><span class="n">tmp</span> <span class="o">&gt;&gt;</span> <span class="n">shift</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">mask</span>
			<span class="k">if</span> <span class="n">value</span> <span class="o">&amp;</span> <span class="n">signMask</span><span class="p">:</span>
				<span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="o">-</span> <span class="n">minusOffset</span>
			<span class="n">DeltaValue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">DeltaValue</span></div>

<div class="viewcode-block" id="DeltaValue.write"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.DeltaValue.write">[docs]</a>	<span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">repeatIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="n">StartSize</span> <span class="o">=</span> <span class="n">tableDict</span><span class="p">[</span><span class="s2">&quot;StartSize&quot;</span><span class="p">]</span>
		<span class="n">EndSize</span> <span class="o">=</span> <span class="n">tableDict</span><span class="p">[</span><span class="s2">&quot;EndSize&quot;</span><span class="p">]</span>
		<span class="n">DeltaFormat</span> <span class="o">=</span> <span class="n">tableDict</span><span class="p">[</span><span class="s2">&quot;DeltaFormat&quot;</span><span class="p">]</span>
		<span class="n">DeltaValue</span> <span class="o">=</span> <span class="n">value</span>
		<span class="k">assert</span> <span class="n">DeltaFormat</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="s2">&quot;illegal DeltaFormat&quot;</span>
		<span class="n">nItems</span> <span class="o">=</span> <span class="n">EndSize</span> <span class="o">-</span> <span class="n">StartSize</span> <span class="o">+</span> <span class="mi">1</span>
		<span class="n">nBits</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">DeltaFormat</span>
		<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">DeltaValue</span><span class="p">)</span> <span class="o">==</span> <span class="n">nItems</span>
		<span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">nBits</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

		<span class="n">tmp</span><span class="p">,</span> <span class="n">shift</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">16</span>
		<span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">DeltaValue</span><span class="p">:</span>
			<span class="n">shift</span> <span class="o">=</span> <span class="n">shift</span> <span class="o">-</span> <span class="n">nBits</span>
			<span class="n">tmp</span> <span class="o">=</span> <span class="n">tmp</span> <span class="o">|</span> <span class="p">((</span><span class="n">value</span> <span class="o">&amp;</span> <span class="n">mask</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">shift</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">shift</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
				<span class="n">writer</span><span class="o">.</span><span class="n">writeUShort</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
				<span class="n">tmp</span><span class="p">,</span> <span class="n">shift</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">16</span>
		<span class="k">if</span> <span class="n">shift</span> <span class="o">!=</span> <span class="mi">16</span><span class="p">:</span>
			<span class="n">writer</span><span class="o">.</span><span class="n">writeUShort</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeltaValue.xmlWrite"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.DeltaValue.xmlWrite">[docs]</a>	<span class="k">def</span> <span class="nf">xmlWrite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmlWriter</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">simpletag</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">attrs</span> <span class="o">+</span> <span class="p">[(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)])</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span></div>

<div class="viewcode-block" id="DeltaValue.xmlRead"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.DeltaValue.xmlRead">[docs]</a>	<span class="k">def</span> <span class="nf">xmlRead</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">font</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">safeEval</span><span class="p">(</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">])</span></div></div>


<div class="viewcode-block" id="VarIdxMapValue"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.VarIdxMapValue">[docs]</a><span class="k">class</span> <span class="nc">VarIdxMapValue</span><span class="p">(</span><span class="n">BaseConverter</span><span class="p">):</span>

<div class="viewcode-block" id="VarIdxMapValue.read"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.VarIdxMapValue.read">[docs]</a>	<span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">):</span>
		<span class="n">fmt</span> <span class="o">=</span> <span class="n">tableDict</span><span class="p">[</span><span class="s1">&#39;EntryFormat&#39;</span><span class="p">]</span>
		<span class="n">nItems</span> <span class="o">=</span> <span class="n">tableDict</span><span class="p">[</span><span class="s1">&#39;MappingCount&#39;</span><span class="p">]</span>

		<span class="n">innerBits</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">fmt</span> <span class="o">&amp;</span> <span class="mh">0x000F</span><span class="p">)</span>
		<span class="n">innerMask</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">innerBits</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
		<span class="n">outerMask</span> <span class="o">=</span> <span class="mh">0xFFFFFFFF</span> <span class="o">-</span> <span class="n">innerMask</span>
		<span class="n">outerShift</span> <span class="o">=</span> <span class="mi">16</span> <span class="o">-</span> <span class="n">innerBits</span>

		<span class="n">entrySize</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">((</span><span class="n">fmt</span> <span class="o">&amp;</span> <span class="mh">0x0030</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">)</span>
		<span class="n">read</span> <span class="o">=</span> <span class="p">{</span>
			<span class="mi">1</span><span class="p">:</span> <span class="n">reader</span><span class="o">.</span><span class="n">readUInt8</span><span class="p">,</span>
			<span class="mi">2</span><span class="p">:</span> <span class="n">reader</span><span class="o">.</span><span class="n">readUShort</span><span class="p">,</span>
			<span class="mi">3</span><span class="p">:</span> <span class="n">reader</span><span class="o">.</span><span class="n">readUInt24</span><span class="p">,</span>
			<span class="mi">4</span><span class="p">:</span> <span class="n">reader</span><span class="o">.</span><span class="n">readULong</span><span class="p">,</span>
		<span class="p">}[</span><span class="n">entrySize</span><span class="p">]</span>

		<span class="n">mapping</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nItems</span><span class="p">):</span>
			<span class="n">raw</span> <span class="o">=</span> <span class="n">read</span><span class="p">()</span>
			<span class="n">idx</span> <span class="o">=</span> <span class="p">((</span><span class="n">raw</span> <span class="o">&amp;</span> <span class="n">outerMask</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">outerShift</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">raw</span> <span class="o">&amp;</span> <span class="n">innerMask</span><span class="p">)</span>
			<span class="n">mapping</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>

		<span class="k">return</span> <span class="n">mapping</span></div>

<div class="viewcode-block" id="VarIdxMapValue.write"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.VarIdxMapValue.write">[docs]</a>	<span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">repeatIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="n">fmt</span> <span class="o">=</span> <span class="n">tableDict</span><span class="p">[</span><span class="s1">&#39;EntryFormat&#39;</span><span class="p">]</span>
		<span class="n">mapping</span> <span class="o">=</span> <span class="n">value</span>
		<span class="n">writer</span><span class="p">[</span><span class="s1">&#39;MappingCount&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mapping</span><span class="p">))</span>

		<span class="n">innerBits</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">fmt</span> <span class="o">&amp;</span> <span class="mh">0x000F</span><span class="p">)</span>
		<span class="n">innerMask</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">innerBits</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
		<span class="n">outerShift</span> <span class="o">=</span> <span class="mi">16</span> <span class="o">-</span> <span class="n">innerBits</span>

		<span class="n">entrySize</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">((</span><span class="n">fmt</span> <span class="o">&amp;</span> <span class="mh">0x0030</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">)</span>
		<span class="n">write</span> <span class="o">=</span> <span class="p">{</span>
			<span class="mi">1</span><span class="p">:</span> <span class="n">writer</span><span class="o">.</span><span class="n">writeUInt8</span><span class="p">,</span>
			<span class="mi">2</span><span class="p">:</span> <span class="n">writer</span><span class="o">.</span><span class="n">writeUShort</span><span class="p">,</span>
			<span class="mi">3</span><span class="p">:</span> <span class="n">writer</span><span class="o">.</span><span class="n">writeUInt24</span><span class="p">,</span>
			<span class="mi">4</span><span class="p">:</span> <span class="n">writer</span><span class="o">.</span><span class="n">writeULong</span><span class="p">,</span>
		<span class="p">}[</span><span class="n">entrySize</span><span class="p">]</span>

		<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">mapping</span><span class="p">:</span>
			<span class="n">raw</span> <span class="o">=</span> <span class="p">((</span><span class="n">idx</span> <span class="o">&amp;</span> <span class="mh">0xFFFF0000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">outerShift</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">idx</span> <span class="o">&amp;</span> <span class="n">innerMask</span><span class="p">)</span>
			<span class="n">write</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="VarDataValue"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.VarDataValue">[docs]</a><span class="k">class</span> <span class="nc">VarDataValue</span><span class="p">(</span><span class="n">BaseConverter</span><span class="p">):</span>

<div class="viewcode-block" id="VarDataValue.read"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.VarDataValue.read">[docs]</a>	<span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">):</span>
		<span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>

		<span class="n">regionCount</span> <span class="o">=</span> <span class="n">tableDict</span><span class="p">[</span><span class="s2">&quot;VarRegionCount&quot;</span><span class="p">]</span>
		<span class="n">shortCount</span> <span class="o">=</span> <span class="n">tableDict</span><span class="p">[</span><span class="s2">&quot;NumShorts&quot;</span><span class="p">]</span>

		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">regionCount</span><span class="p">,</span> <span class="n">shortCount</span><span class="p">)):</span>
			<span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reader</span><span class="o">.</span><span class="n">readShort</span><span class="p">())</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">regionCount</span><span class="p">,</span> <span class="n">shortCount</span><span class="p">),</span> <span class="n">regionCount</span><span class="p">):</span>
			<span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reader</span><span class="o">.</span><span class="n">readInt8</span><span class="p">())</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">regionCount</span><span class="p">,</span> <span class="n">shortCount</span><span class="p">):</span>
			<span class="n">reader</span><span class="o">.</span><span class="n">readInt8</span><span class="p">()</span>

		<span class="k">return</span> <span class="n">values</span></div>

<div class="viewcode-block" id="VarDataValue.write"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.VarDataValue.write">[docs]</a>	<span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">repeatIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="n">regionCount</span> <span class="o">=</span> <span class="n">tableDict</span><span class="p">[</span><span class="s2">&quot;VarRegionCount&quot;</span><span class="p">]</span>
		<span class="n">shortCount</span> <span class="o">=</span> <span class="n">tableDict</span><span class="p">[</span><span class="s2">&quot;NumShorts&quot;</span><span class="p">]</span>

		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">regionCount</span><span class="p">,</span> <span class="n">shortCount</span><span class="p">)):</span>
			<span class="n">writer</span><span class="o">.</span><span class="n">writeShort</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">regionCount</span><span class="p">,</span> <span class="n">shortCount</span><span class="p">),</span> <span class="n">regionCount</span><span class="p">):</span>
			<span class="n">writer</span><span class="o">.</span><span class="n">writeInt8</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">regionCount</span><span class="p">,</span> <span class="n">shortCount</span><span class="p">):</span>
			<span class="n">writer</span><span class="o">.</span><span class="n">writeInt8</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="VarDataValue.xmlWrite"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.VarDataValue.xmlWrite">[docs]</a>	<span class="k">def</span> <span class="nf">xmlWrite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmlWriter</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">simpletag</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">attrs</span> <span class="o">+</span> <span class="p">[(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)])</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span></div>

<div class="viewcode-block" id="VarDataValue.xmlRead"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.VarDataValue.xmlRead">[docs]</a>	<span class="k">def</span> <span class="nf">xmlRead</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">font</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">safeEval</span><span class="p">(</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">])</span></div></div>

<div class="viewcode-block" id="LookupFlag"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.LookupFlag">[docs]</a><span class="k">class</span> <span class="nc">LookupFlag</span><span class="p">(</span><span class="n">UShort</span><span class="p">):</span>
<div class="viewcode-block" id="LookupFlag.xmlWrite"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.LookupFlag.xmlWrite">[docs]</a>	<span class="k">def</span> <span class="nf">xmlWrite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmlWriter</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">simpletag</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">attrs</span> <span class="o">+</span> <span class="p">[(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)])</span>
		<span class="n">flags</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">if</span> <span class="n">value</span> <span class="o">&amp;</span> <span class="mh">0x01</span><span class="p">:</span> <span class="n">flags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;rightToLeft&quot;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">value</span> <span class="o">&amp;</span> <span class="mh">0x02</span><span class="p">:</span> <span class="n">flags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;ignoreBaseGlyphs&quot;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">value</span> <span class="o">&amp;</span> <span class="mh">0x04</span><span class="p">:</span> <span class="n">flags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;ignoreLigatures&quot;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">value</span> <span class="o">&amp;</span> <span class="mh">0x08</span><span class="p">:</span> <span class="n">flags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;ignoreMarks&quot;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">value</span> <span class="o">&amp;</span> <span class="mh">0x10</span><span class="p">:</span> <span class="n">flags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;useMarkFilteringSet&quot;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">value</span> <span class="o">&amp;</span> <span class="mh">0xff00</span><span class="p">:</span> <span class="n">flags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;markAttachmentType[</span><span class="si">%i</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">value</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">))</span>
		<span class="k">if</span> <span class="n">flags</span><span class="p">:</span>
			<span class="n">xmlWriter</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">flags</span><span class="p">))</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span></div></div>

<span class="k">def</span> <span class="nf">_issubclass_namedtuple</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
	<span class="k">return</span> <span class="p">(</span>
		<span class="nb">issubclass</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
		<span class="ow">and</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s2">&quot;_fields&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
	<span class="p">)</span>


<span class="k">class</span> <span class="nc">_NamedTupleConverter</span><span class="p">(</span><span class="n">BaseConverter</span><span class="p">):</span>
	<span class="c1"># subclasses must override this</span>
	<span class="n">tupleClass</span> <span class="o">=</span> <span class="bp">NotImplemented</span>
	<span class="c1"># List[SimpleValue]</span>
	<span class="n">converterClasses</span> <span class="o">=</span> <span class="bp">NotImplemented</span>

	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">repeat</span><span class="p">,</span> <span class="n">aux</span><span class="p">,</span> <span class="n">tableClass</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="c1"># we expect all converters to be subclasses of SimpleValue</span>
		<span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">klass</span><span class="p">,</span> <span class="n">SimpleValue</span><span class="p">)</span> <span class="k">for</span> <span class="n">klass</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">converterClasses</span><span class="p">)</span>
		<span class="k">assert</span> <span class="n">_issubclass_namedtuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tupleClass</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tupleClass</span><span class="p">)</span>
		<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tupleClass</span><span class="o">.</span><span class="n">_fields</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">converterClasses</span><span class="p">)</span>
		<span class="k">assert</span> <span class="n">tableClass</span> <span class="ow">is</span> <span class="kc">None</span>  <span class="c1"># tableClass is unused by SimplValues</span>
		<span class="n">BaseConverter</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">repeat</span><span class="p">,</span> <span class="n">aux</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">converters</span> <span class="o">=</span> <span class="p">[</span>
			<span class="n">klass</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">repeat</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">aux</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
			<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">klass</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tupleClass</span><span class="o">.</span><span class="n">_fields</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">converterClasses</span><span class="p">)</span>
		<span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">convertersByName</span> <span class="o">=</span> <span class="p">{</span><span class="n">conv</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">conv</span> <span class="k">for</span> <span class="n">conv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">converters</span><span class="p">}</span>
		<span class="c1"># returned by getRecordSize method</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">staticSize</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">staticSize</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">converters</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">):</span>
		<span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
			<span class="n">conv</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">conv</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">)</span>
			<span class="k">for</span> <span class="n">conv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">converters</span>
		<span class="p">}</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tupleClass</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">repeatIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="k">for</span> <span class="n">conv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">converters</span><span class="p">:</span>
			<span class="n">v</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">conv</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
			<span class="c1"># repeatIndex is unused for SimpleValues</span>
			<span class="n">conv</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">repeatIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">xmlWrite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmlWriter</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>
		<span class="k">assert</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
		<span class="n">defaults</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="fm">__new__</span><span class="o">.</span><span class="vm">__defaults__</span> <span class="ow">or</span> <span class="p">()</span>
		<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">converters</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">defaults</span><span class="p">)</span>
		<span class="n">values</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="n">required</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">conv</span><span class="p">,</span> <span class="n">default</span> <span class="ow">in</span> <span class="n">zip_longest</span><span class="p">(</span>
			<span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">converters</span><span class="p">),</span>
			<span class="nb">reversed</span><span class="p">(</span><span class="n">defaults</span><span class="p">),</span>
			<span class="n">fillvalue</span><span class="o">=</span><span class="n">required</span><span class="p">,</span>
		<span class="p">):</span>
			<span class="n">v</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">conv</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="n">required</span> <span class="ow">or</span> <span class="n">v</span> <span class="o">!=</span> <span class="n">default</span><span class="p">:</span>
				<span class="n">values</span><span class="p">[</span><span class="n">conv</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">conv</span><span class="o">.</span><span class="n">toString</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">attrs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
			<span class="n">attrs</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">attrs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
			<span class="p">(</span><span class="n">conv</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">values</span><span class="p">[</span><span class="n">conv</span><span class="o">.</span><span class="n">name</span><span class="p">])</span>
			<span class="k">for</span> <span class="n">conv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">converters</span>
			<span class="k">if</span> <span class="n">conv</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">values</span>
		<span class="p">)</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">simpletag</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span>
		<span class="n">xmlWriter</span><span class="o">.</span><span class="n">newline</span><span class="p">()</span>

	<span class="k">def</span> <span class="nf">xmlRead</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">font</span><span class="p">):</span>
		<span class="n">converters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convertersByName</span>
		<span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
			<span class="n">k</span><span class="p">:</span> <span class="n">converters</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">fromString</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
			<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">attrs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
		<span class="p">}</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tupleClass</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<div class="viewcode-block" id="VariableScalar"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.VariableScalar">[docs]</a><span class="k">class</span> <span class="nc">VariableScalar</span><span class="p">(</span><span class="n">_NamedTupleConverter</span><span class="p">):</span>
	<span class="n">tupleClass</span> <span class="o">=</span> <span class="n">VariableFloat</span>
	<span class="n">converterClasses</span> <span class="o">=</span> <span class="p">[</span><span class="n">Fixed</span><span class="p">,</span> <span class="n">ULong</span><span class="p">]</span></div>


<div class="viewcode-block" id="VariableNormalizedScalar"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.VariableNormalizedScalar">[docs]</a><span class="k">class</span> <span class="nc">VariableNormalizedScalar</span><span class="p">(</span><span class="n">_NamedTupleConverter</span><span class="p">):</span>
	<span class="n">tupleClass</span> <span class="o">=</span> <span class="n">VariableFloat</span>
	<span class="n">converterClasses</span> <span class="o">=</span> <span class="p">[</span><span class="n">F2Dot14</span><span class="p">,</span> <span class="n">ULong</span><span class="p">]</span></div>


<div class="viewcode-block" id="VariablePosition"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.VariablePosition">[docs]</a><span class="k">class</span> <span class="nc">VariablePosition</span><span class="p">(</span><span class="n">_NamedTupleConverter</span><span class="p">):</span>
	<span class="n">tupleClass</span> <span class="o">=</span> <span class="n">VariableInt</span>
	<span class="n">converterClasses</span> <span class="o">=</span> <span class="p">[</span><span class="n">Short</span><span class="p">,</span> <span class="n">ULong</span><span class="p">]</span></div>


<div class="viewcode-block" id="VariableDistance"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.VariableDistance">[docs]</a><span class="k">class</span> <span class="nc">VariableDistance</span><span class="p">(</span><span class="n">_NamedTupleConverter</span><span class="p">):</span>
	<span class="n">tupleClass</span> <span class="o">=</span> <span class="n">VariableInt</span>
	<span class="n">converterClasses</span> <span class="o">=</span> <span class="p">[</span><span class="n">UShort</span><span class="p">,</span> <span class="n">ULong</span><span class="p">]</span></div>


<div class="viewcode-block" id="ExtendMode"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.ExtendMode">[docs]</a><span class="k">class</span> <span class="nc">ExtendMode</span><span class="p">(</span><span class="n">UShort</span><span class="p">):</span>
<div class="viewcode-block" id="ExtendMode.read"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.ExtendMode.read">[docs]</a>	<span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">_ExtendMode</span><span class="p">(</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">reader</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">tableDict</span><span class="p">))</span></div>
<div class="viewcode-block" id="ExtendMode.fromString"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.ExtendMode.fromString">[docs]</a>	<span class="nd">@staticmethod</span>
	<span class="k">def</span> <span class="nf">fromString</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
		<span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">_ExtendMode</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span></div>
<div class="viewcode-block" id="ExtendMode.toString"><a class="viewcode-back" href="../../../../ttLib/tables.html#fontTools.ttLib.tables.otConverters.ExtendMode.toString">[docs]</a>	<span class="nd">@staticmethod</span>
	<span class="k">def</span> <span class="nf">toString</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">_ExtendMode</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span></div></div>


<span class="n">converterMapping</span> <span class="o">=</span> <span class="p">{</span>
	<span class="c1"># type		class</span>
	<span class="s2">&quot;int8&quot;</span><span class="p">:</span>		<span class="n">Int8</span><span class="p">,</span>
	<span class="s2">&quot;int16&quot;</span><span class="p">:</span>	<span class="n">Short</span><span class="p">,</span>
	<span class="s2">&quot;uint8&quot;</span><span class="p">:</span>	<span class="n">UInt8</span><span class="p">,</span>
	<span class="s2">&quot;uint8&quot;</span><span class="p">:</span>	<span class="n">UInt8</span><span class="p">,</span>
	<span class="s2">&quot;uint16&quot;</span><span class="p">:</span>	<span class="n">UShort</span><span class="p">,</span>
	<span class="s2">&quot;uint24&quot;</span><span class="p">:</span>	<span class="n">UInt24</span><span class="p">,</span>
	<span class="s2">&quot;uint32&quot;</span><span class="p">:</span>	<span class="n">ULong</span><span class="p">,</span>
	<span class="s2">&quot;char64&quot;</span><span class="p">:</span>	<span class="n">Char64</span><span class="p">,</span>
	<span class="s2">&quot;Flags32&quot;</span><span class="p">:</span>	<span class="n">Flags32</span><span class="p">,</span>
	<span class="s2">&quot;Version&quot;</span><span class="p">:</span>	<span class="n">Version</span><span class="p">,</span>
	<span class="s2">&quot;Tag&quot;</span><span class="p">:</span>		<span class="n">Tag</span><span class="p">,</span>
	<span class="s2">&quot;GlyphID&quot;</span><span class="p">:</span>	<span class="n">GlyphID</span><span class="p">,</span>
	<span class="s2">&quot;NameID&quot;</span><span class="p">:</span>	<span class="n">NameID</span><span class="p">,</span>
	<span class="s2">&quot;DeciPoints&quot;</span><span class="p">:</span>	<span class="n">DeciPoints</span><span class="p">,</span>
	<span class="s2">&quot;Fixed&quot;</span><span class="p">:</span>	<span class="n">Fixed</span><span class="p">,</span>
	<span class="s2">&quot;F2Dot14&quot;</span><span class="p">:</span>	<span class="n">F2Dot14</span><span class="p">,</span>
	<span class="s2">&quot;struct&quot;</span><span class="p">:</span>	<span class="n">Struct</span><span class="p">,</span>
	<span class="s2">&quot;Offset&quot;</span><span class="p">:</span>	<span class="n">Table</span><span class="p">,</span>
	<span class="s2">&quot;LOffset&quot;</span><span class="p">:</span>	<span class="n">LTable</span><span class="p">,</span>
	<span class="s2">&quot;ValueRecord&quot;</span><span class="p">:</span>	<span class="n">ValueRecord</span><span class="p">,</span>
	<span class="s2">&quot;DeltaValue&quot;</span><span class="p">:</span>	<span class="n">DeltaValue</span><span class="p">,</span>
	<span class="s2">&quot;VarIdxMapValue&quot;</span><span class="p">:</span>	<span class="n">VarIdxMapValue</span><span class="p">,</span>
	<span class="s2">&quot;VarDataValue&quot;</span><span class="p">:</span>	<span class="n">VarDataValue</span><span class="p">,</span>
	<span class="s2">&quot;LookupFlag&quot;</span><span class="p">:</span> <span class="n">LookupFlag</span><span class="p">,</span>
	<span class="s2">&quot;ExtendMode&quot;</span><span class="p">:</span> <span class="n">ExtendMode</span><span class="p">,</span>

	<span class="c1"># AAT</span>
	<span class="s2">&quot;CIDGlyphMap&quot;</span><span class="p">:</span>	<span class="n">CIDGlyphMap</span><span class="p">,</span>
	<span class="s2">&quot;GlyphCIDMap&quot;</span><span class="p">:</span>	<span class="n">GlyphCIDMap</span><span class="p">,</span>
	<span class="s2">&quot;MortChain&quot;</span><span class="p">:</span>	<span class="n">StructWithLength</span><span class="p">,</span>
	<span class="s2">&quot;MortSubtable&quot;</span><span class="p">:</span> <span class="n">StructWithLength</span><span class="p">,</span>
	<span class="s2">&quot;MorxChain&quot;</span><span class="p">:</span>	<span class="n">StructWithLength</span><span class="p">,</span>
	<span class="s2">&quot;MorxSubtable&quot;</span><span class="p">:</span> <span class="n">MorxSubtableConverter</span><span class="p">,</span>

	<span class="c1"># &quot;Template&quot; types</span>
	<span class="s2">&quot;AATLookup&quot;</span><span class="p">:</span>	<span class="k">lambda</span> <span class="n">C</span><span class="p">:</span> <span class="n">partial</span><span class="p">(</span><span class="n">AATLookup</span><span class="p">,</span> <span class="n">tableClass</span><span class="o">=</span><span class="n">C</span><span class="p">),</span>
	<span class="s2">&quot;AATLookupWithDataOffset&quot;</span><span class="p">:</span>	<span class="k">lambda</span> <span class="n">C</span><span class="p">:</span> <span class="n">partial</span><span class="p">(</span><span class="n">AATLookupWithDataOffset</span><span class="p">,</span> <span class="n">tableClass</span><span class="o">=</span><span class="n">C</span><span class="p">),</span>
	<span class="s2">&quot;STXHeader&quot;</span><span class="p">:</span>	<span class="k">lambda</span> <span class="n">C</span><span class="p">:</span> <span class="n">partial</span><span class="p">(</span><span class="n">STXHeader</span><span class="p">,</span> <span class="n">tableClass</span><span class="o">=</span><span class="n">C</span><span class="p">),</span>
	<span class="s2">&quot;OffsetTo&quot;</span><span class="p">:</span>	<span class="k">lambda</span> <span class="n">C</span><span class="p">:</span> <span class="n">partial</span><span class="p">(</span><span class="n">Table</span><span class="p">,</span> <span class="n">tableClass</span><span class="o">=</span><span class="n">C</span><span class="p">),</span>
	<span class="s2">&quot;LOffsetTo&quot;</span><span class="p">:</span>	<span class="k">lambda</span> <span class="n">C</span><span class="p">:</span> <span class="n">partial</span><span class="p">(</span><span class="n">LTable</span><span class="p">,</span> <span class="n">tableClass</span><span class="o">=</span><span class="n">C</span><span class="p">),</span>

	<span class="c1"># Variable types</span>
	<span class="s2">&quot;VariableScalar&quot;</span><span class="p">:</span> <span class="n">VariableScalar</span><span class="p">,</span>
	<span class="s2">&quot;VariableNormalizedScalar&quot;</span><span class="p">:</span> <span class="n">VariableNormalizedScalar</span><span class="p">,</span>
	<span class="s2">&quot;VariablePosition&quot;</span><span class="p">:</span> <span class="n">VariablePosition</span><span class="p">,</span>
	<span class="s2">&quot;VariableDistance&quot;</span><span class="p">:</span> <span class="n">VariableDistance</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Just van Rossum, Behdad Esfahbod, and the fontTools Authors. CC BY-SA 4.0

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>